---

title: Data Preparation


keywords: fastai
sidebar: home_sidebar

summary: "Prepare your data"
description: "Prepare your data"
nb_path: "0_data_prepare.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 0_data_prepare.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Import">Import<a class="anchor-link" href="#Import"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sagemaker</span>
<span class="kn">import</span> <span class="nn">boto3</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">io</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">LOCAL_DIR</span> <span class="o">=</span> <span class="s1">&#39;data&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Input-Raw-Data-S3-location">Input Raw Data S3 location<a class="anchor-link" href="#Input-Raw-Data-S3-location"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s3_bucket</span> <span class="o">=</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span><span class="o">.</span><span class="n">default_bucket</span><span class="p">()</span>
<span class="n">s3_input_prefix</span> <span class="o">=</span> <span class="s1">&#39;heidelberg/data&#39;</span>
<span class="n">s3_input_filename</span> <span class="o">=</span> <span class="s1">&#39;data.csv&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Get-dataframe-from-s3">Get dataframe from s3<a class="anchor-link" href="#Get-dataframe-from-s3"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">Object</span><span class="p">(</span><span class="n">s3_bucket</span><span class="p">,</span> <span class="n">s3_input_prefix</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">s3_input_filename</span><span class="p">)</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">()[</span><span class="s1">&#39;Body&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">body</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="transfrom-column-name-if(invalid)">transfrom column name if(invalid)<a class="anchor-link" href="#transfrom-column-name-if(invalid)"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># output : transformed column name (string)a</span>

<span class="k">def</span> <span class="nf">transform_column_name</span><span class="p">(</span><span class="n">column_name</span><span class="p">):</span>
    <span class="n">allowed_values</span> <span class="o">=</span> <span class="s2">&quot;01234567890abcdefghijklmnopqrstuvwxyz&quot;</span>
    <span class="n">new_column_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">column_name</span><span class="o">=</span><span class="n">column_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">count</span> <span class="o">=</span><span class="mi">0</span> 
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">column_name</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_values</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">count</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">new_column_name</span> <span class="o">=</span> <span class="n">new_column_name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span>
            <span class="n">i</span><span class="o">=</span><span class="s1">&#39;_&#39;</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">new_column_name</span> <span class="o">=</span> <span class="n">new_column_name</span> <span class="o">+</span> <span class="n">i</span>
        <span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">new_column_name</span> <span class="o">=</span> <span class="n">new_column_name</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">90</span><span class="p">]</span>
        
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;new_column_name : &quot;</span><span class="p">,</span><span class="n">new_column_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_column_name</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Inserting-Unique-Identifier-column-as-id">Inserting Unique Identifier column as id<a class="anchor-link" href="#Inserting-Unique-Identifier-column-as-id"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">=</span> <span class="p">[</span>  <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Inserting-timestamp">Inserting timestamp<a class="anchor-link" href="#Inserting-timestamp"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">dateutil.parser</span> <span class="k">as</span> <span class="nn">parser</span>

<span class="k">def</span> <span class="nf">generate_timestamps</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s1">&#39;2020-01-01 00:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s1">&#39;2020-06-01 00:01:00&#39;</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
    <span class="n">timestamps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">faker</span><span class="o">.</span><span class="n">date_time_between</span><span class="p">(</span><span class="n">start_date</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="n">end</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
        <span class="n">timestamps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="n">timestamps</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">timestamps</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">timestamps</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;event_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())]</span><span class="o">*</span><span class="n">l</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Move-target-column-to-start-(-if-you-are-using-Xgboost)">Move target column to start ( if you are using Xgboost)<a class="anchor-link" href="#Move-target-column-to-start-(-if-you-are-using-Xgboost)"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span> <span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="o">!=</span> <span class="s1">&#39;target&#39;</span> <span class="p">]</span> <span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Drop-unwanted-columns">Drop unwanted columns<a class="anchor-link" href="#Drop-unwanted-columns"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">del</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;is_outlier&#39;</span><span class="p">]</span>
<span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;target&#39;,
 &#39;kst_brutto&#39;,
 &#39;sm&#39;,
 &#39;tm&#39;,
 &#39;cl&#39;,
 &#39;so3&#39;,
 &#39;k2o&#39;,
 &#39;na2o&#39;,
 &#39;south_kiln_feed_01om886__tph__avg&#39;,
 &#39;south_kiln_feed_01om886__tph__max&#39;,
 &#39;north_kiln_feed_01om885__tph__avg&#39;,
 &#39;north_kiln_feed_01om885__tph__max&#39;,
 &#39;north_fan_speed_01oa943__rpm__avg&#39;,
 &#39;north_fan_speed_01oa943__rpm__max&#39;,
 &#39;south_fan_speed_02oa943__rpm__avg&#39;,
 &#39;south_fan_speed_02oa943__rpm__max&#39;,
 &#39;lignite_main_burner_03sk820__tph__avg&#39;,
 &#39;lignite_main_burner_03sk820__tph__max&#39;,
 &#39;bpg_main_burner_03bf810__tph__avg&#39;,
 &#39;bpg_main_burner_03bf810__tph__max&#39;,
 &#39;lignite_calciner_02sk820__tph__avg&#39;,
 &#39;lignite_calciner_02sk820__tph__max&#39;,
 &#39;bpg_calciner_02bf810__tph__avg&#39;,
 &#39;bpg_calciner_02bf810__tph__max&#39;,
 &#39;kbs_calciner_00kb950__tph__avg&#39;,
 &#39;kbs_calciner_00kb950__tph__max&#39;,
 &#39;total_energy_to_main_burner__gj_h__avg_0&#39;,
 &#39;total_energy_to_main_burner__gj_h__max_0&#39;,
 &#39;total_energy_to_main_burner__gj_h__avg_1&#39;,
 &#39;total_energy_to_main_burner__gj_h__max_1&#39;,
 &#39;total_energy_to_main_burner__gj_h__avg_2&#39;,
 &#39;total_energy_to_main_burner__gj_h__max_2&#39;,
 &#39;total_energy_to_main_burner__gj_h__avg_3&#39;,
 &#39;total_energy_to_main_burner__gj_h__max_3&#39;,
 &#39;total_energy_to_calciner__gj_h__avg_0&#39;,
 &#39;total_energy_to_calciner__gj_h__max_0&#39;,
 &#39;total_energy_to_calciner__gj_h__avg_1&#39;,
 &#39;total_energy_to_calciner__gj_h__max_1&#39;,
 &#39;total_energy_to_calciner__gj_h__avg_2&#39;,
 &#39;total_energy_to_calciner__gj_h__max_2&#39;,
 &#39;total_energy_to_calciner__gj_h__avg_3&#39;,
 &#39;total_energy_to_calciner__gj_h__max_3&#39;,
 &#39;tf__traditional_fuel__avg&#39;,
 &#39;tf__traditional_fuel__max&#39;,
 &#39;af__alternative_fuel__avg&#39;,
 &#39;af__alternative_fuel__max&#39;,
 &#39;shc__gj__t_kiln_feed__avg&#39;,
 &#39;shc__gj__t_kiln_feed__max&#39;,
 &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_0&#39;,
 &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__max_0&#39;,
 &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_1&#39;,
 &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__max_1&#39;,
 &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_2&#39;,
 &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__max_2&#39;,
 &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_3&#39;,
 &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__max_3&#39;,
 &#39;co_concentration_in_kiln_inlet_00oa981__ppm__avg&#39;,
 &#39;co_concentration_in_kiln_inlet_00oa981__ppm__max&#39;,
 &#39;o2_concentration_in_kiln_inlet_00oa982_____avg&#39;,
 &#39;o2_concentration_in_kiln_inlet_00oa982_____max&#39;,
 &#39;bottom_cyclone_gas_temperature_00oa800___c___avg&#39;,
 &#39;bottom_cyclone_gas_temperature_00oa800___c___max&#39;,
 &#39;secondary_air_temperature_01kk827___c___avg_0&#39;,
 &#39;secondary_air_temperature_01kk827___c___max_0&#39;,
 &#39;secondary_air_temperature_01kk827___c___avg_1&#39;,
 &#39;secondary_air_temperature_01kk827___c___max_1&#39;,
 &#39;secondary_air_temperature_01kk827___c___avg_2&#39;,
 &#39;secondary_air_temperature_01kk827___c___max_2&#39;,
 &#39;secondary_air_temperature_01kk827___c___avg_3&#39;,
 &#39;secondary_air_temperature_01kk827___c___max_3&#39;,
 &#39;tertiary_air_temperature_01kb801___c___avg_0&#39;,
 &#39;tertiary_air_temperature_01kb801___c___max_0&#39;,
 &#39;tertiary_air_temperature_01kb801___c___avg_1&#39;,
 &#39;tertiary_air_temperature_01kb801___c___max_1&#39;,
 &#39;tertiary_air_temperature_01kb801___c___avg_2&#39;,
 &#39;tertiary_air_temperature_01kb801___c___max_2&#39;,
 &#39;tertiary_air_temperature_01kb801___c___avg_3&#39;,
 &#39;tertiary_air_temperature_01kb801___c___max_3&#39;,
 &#39;kiln_amps_01do812__amps__avg_0&#39;,
 &#39;kiln_amps_01do812__amps__max_0&#39;,
 &#39;kiln_amps_01do812__amps__avg_1&#39;,
 &#39;kiln_amps_01do812__amps__max_1&#39;,
 &#39;kiln_amps_01do812__amps__avg_2&#39;,
 &#39;kiln_amps_01do812__amps__max_2&#39;,
 &#39;kiln_amps_01do812__amps__avg_3&#39;,
 &#39;kiln_amps_01do812__amps__max_3&#39;,
 &#39;co_bottom_cyclone_north_00oa941__amps__avg&#39;,
 &#39;co_bottom_cyclone_north_00oa941__amps__max&#39;,
 &#39;o2_bottom_cyclone_north_00oa942_____avg_0&#39;,
 &#39;o2_bottom_cyclone_north_00oa942_____max_0&#39;,
 &#39;o2_bottom_cyclone_north_00oa942_____avg_1&#39;,
 &#39;o2_bottom_cyclone_north_00oa942_____max_1&#39;,
 &#39;o2_bottom_cyclone_north_00oa942_____avg_2&#39;,
 &#39;o2_bottom_cyclone_north_00oa942_____max_2&#39;,
 &#39;o2_bottom_cyclone_north_00oa942_____avg_3&#39;,
 &#39;o2_bottom_cyclone_north_00oa942_____max_3&#39;,
 &#39;kiln_speed_01do811__rpm__avg&#39;,
 &#39;kiln_speed_01do811__rpm__max&#39;,
 &#39;primary_air_amount_01of850__nm3_h___avg&#39;,
 &#39;primary_air_amount_01of850__nm3_h___max&#39;,
 &#39;axial_air_pressure_01of811__mbar__avg&#39;,
 &#39;axial_air_pressure_01of811__mbar__max&#39;,
 &#39;radial_air_pressure_01of812__mbar__avg&#39;,
 &#39;radial_air_pressure_01of812__mbar__max&#39;,
 &#39;central_air_pressure_01of813__mbar__avg&#39;,
 &#39;central_air_pressure_01of813__mbar__max&#39;,
 &#39;total_feed_avg&#39;,
 &#39;total_feed_max&#39;,
 &#39;total_energy_avg&#39;,
 &#39;total_energy_max&#39;,
 &#39;average_fan_speed_avg&#39;,
 &#39;average_fan_speed_max&#39;,
 &#39;average_air_temperature_avg&#39;,
 &#39;average_air_temperature_max&#39;,
 &#39;kiln_feed_rate_avg&#39;,
 &#39;kiln_feed_rate_max&#39;,
 &#39;klinker___nk_c3s_lag_shift&#39;,
 &#39;klinker___nk_mgo_lag_shift&#39;,
 &#39;klinker___nk_fe2o3_lag_shift&#39;,
 &#39;klinker___nk_al2o3_lag_shift&#39;,
 &#39;klinker___nk_na2o_lag_shift&#39;,
 &#39;klinker___nk_k2o_lag_shift&#39;,
 &#39;klinker___nk_cao_lag_shift&#39;,
 &#39;klinker___nk_sio2_lag_shift&#39;,
 &#39;heat_of_formation__kcal_kg_clinker__lag_shift&#39;,
 &#39;klinker___nk_so3_lag_shift&#39;,
 &#39;klinker___nk_sm_lag_shift&#39;,
 &#39;klinker___nk_am_lag_shift&#39;,
 &#39;klinker___nk_lsf_lag_shift&#39;,
 &#39;id&#39;,
 &#39;event_time&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">LOCAL_DIR</span><span class="si">}</span><span class="s1">/test.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Upload-transfromed-data-to-S3-bucket">Upload transfromed data to S3 bucket<a class="anchor-link" href="#Upload-transfromed-data-to-S3-bucket"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>aws s3 cp <span class="o">{</span>LOCAL_DIR<span class="o">}</span>/test.csv s3://<span class="o">{</span>s3_bucket<span class="o">}</span>/<span class="o">{</span>s3_input_prefix<span class="o">}</span>/transformed.csv
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>upload: data/test.csv to s3://sagemaker-us-east-1-082830052325/heidelberg/data/transformed.csv
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>rm <span class="o">{</span>LOCAL_DIR<span class="o">}</span>/test.csv
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="(Optional)-for-Testing-purpose">(Optional) for Testing purpose<a class="anchor-link" href="#(Optional)-for-Testing-purpose"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">check</span><span class="p">():</span>
    <span class="n">transformed_path</span> <span class="o">=</span> <span class="s1">&#39;heidelberg/data/transfomed.csv&#39;</span>
    <span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">Object</span><span class="p">(</span><span class="n">s3_bucket</span><span class="p">,</span> <span class="n">transformed_path</span><span class="p">)</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">()[</span><span class="s1">&#39;Body&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">body</span><span class="p">))</span>
    <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="s2">&quot;Unname&quot;</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

