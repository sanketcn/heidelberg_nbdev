---

title: Setup


keywords: fastai
sidebar: home_sidebar

summary: "The objective that we want to achieve is to establish the right playbooks that would help us in"
description: "The objective that we want to achieve is to establish the right playbooks that would help us in"
nb_path: "1_setup.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 1_setup.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Imports">Imports<a class="anchor-link" href="#Imports"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">sagemaker</span>
<span class="kn">import</span> <span class="nn">boto3</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">io</span>

<span class="kn">from</span> <span class="nn">sagemaker.session</span> <span class="kn">import</span> <span class="n">Session</span>
<span class="kn">from</span> <span class="nn">sagemaker.feature_store.feature_group</span> <span class="kn">import</span> <span class="n">FeatureGroup</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">sagemaker</span> <span class="kn">import</span> <span class="n">get_execution_role</span>
<span class="kn">from</span> <span class="nn">sagemaker.spark.processing</span> <span class="kn">import</span> <span class="n">PySparkProcessor</span>
<span class="kn">from</span> <span class="nn">argparse</span> <span class="kn">import</span> <span class="n">Namespace</span><span class="p">,</span> <span class="n">ArgumentParser</span>


<span class="c1"># to get the latest sagemaker python sdk</span>
<span class="c1">#!pip install -U sagemaker</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Constants">Constants<a class="anchor-link" href="#Constants"> </a></h2><p><strong>NOTE:</strong> Before running this notebook, be sure to set the stack name in the first code cell to match the name of the CloudFormation stack you used to create this notebook instance. If you used the default stack name, you should not need to make any updates.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">STACK_NAME</span> <span class="o">=</span> <span class="s1">&#39;heidelberg-mlops-stack-3&#39;</span> <span class="c1"># if you&#39;re not using the default stack name, replace this</span>
<span class="o">%</span><span class="k">store</span> STACK_NAME

<span class="n">STREAM_NAME</span><span class="o">=</span><span class="s1">&#39;heidelberg-mlops-stream&#39;</span>
<span class="o">%</span><span class="k">store</span> STREAM_NAME

<span class="n">APPLICATION_NAME</span><span class="o">=</span><span class="s1">&#39;heidelberg-mlops-app&#39;</span>
<span class="o">%</span><span class="k">store</span> APPLICATION_NAME

<span class="n">LOCAL_DIR</span><span class="o">=</span><span class="s1">&#39;data&#39;</span>
<span class="o">%</span><span class="k">store</span> LOCAL_DIR
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Stored &#39;STACK_NAME&#39; (str)
Stored &#39;STREAM_NAME&#39; (str)
Stored &#39;APPLICATION_NAME&#39; (str)
Stored &#39;LOCAL_DIR&#39; (str)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Clients">Clients<a class="anchor-link" href="#Clients"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">role</span> <span class="o">=</span> <span class="n">get_execution_role</span><span class="p">()</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="n">service_name</span><span class="o">=</span><span class="s1">&#39;sagemaker&#39;</span><span class="p">)</span>
<span class="n">smfs_runtime</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="n">service_name</span><span class="o">=</span><span class="s1">&#39;sagemaker-featurestore-runtime&#39;</span><span class="p">)</span>

<span class="n">boto_session</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">(</span><span class="n">region_name</span><span class="o">=</span><span class="s2">&quot;us-east-1&quot;</span><span class="p">)</span>
<span class="n">s3_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="n">cf_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;cloudformation&#39;</span><span class="p">)</span>
<span class="n">kinesis_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;kinesis&#39;</span><span class="p">)</span>
<span class="n">lambda_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;lambda&#39;</span><span class="p">)</span>
<span class="n">kda_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;kinesisanalytics&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data">Data<a class="anchor-link" href="#Data"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li>Specify the Transformed data s3 location</li>
<li>If you have run the data_preparation_notebook then do not change this othewise specify your s3_data location</li>
</ol>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s3_bucket</span> <span class="o">=</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span><span class="o">.</span><span class="n">default_bucket</span><span class="p">()</span>
<span class="n">s3_prefix</span> <span class="o">=</span> <span class="s1">&#39;heidelberg/data&#39;</span>

<span class="n">s3_transformed_data_filename</span> <span class="o">=</span> <span class="s2">&quot;transformed.csv&quot;</span>

<span class="n">s3_transformed_data_path</span><span class="o">=</span><span class="s2">&quot;s3://</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s3_bucket</span><span class="p">,</span><span class="n">s3_prefix</span><span class="p">,</span><span class="n">s3_transformed_data_filename</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Make sure trasformed data is present at : &quot;</span> <span class="p">,</span><span class="n">s3_transformed_data_path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Make sure trasformed data is present at :  s3://sagemaker-us-east-1-082830052325/heidelberg/data/transformed.csv
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Setup">Setup<a class="anchor-link" href="#Setup"> </a></h1><ol>
<li>Create feature groups</li>
<li>Create an Amazon Kinesis data stream</li>
<li>Create an Amazon Kinesis Data Applications (KDA) application</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Get-ARN's-of-Lambda-functions-from-CloudFormation-stack-outputs">Get ARN's of Lambda functions from CloudFormation stack outputs<a class="anchor-link" href="#Get-ARN's-of-Lambda-functions-from-CloudFormation-stack-outputs"> </a></h3><ol>
<li>InvokeFraudEndpointLambdaARN</li>
<li>StreamingAggLambdaARN</li>
</ol>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">cf_client</span><span class="o">.</span><span class="n">describe_stacks</span><span class="p">(</span><span class="n">StackName</span><span class="o">=</span><span class="n">STACK_NAME</span><span class="p">)[</span><span class="s1">&#39;Stacks&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Outputs&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">outputs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">o</span><span class="p">[</span><span class="s1">&#39;OutputKey&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;IngestLambdaFunctionARN&#39;</span><span class="p">:</span>
            <span class="n">lambda_to_fs_arn</span> <span class="o">=</span> <span class="n">o</span><span class="p">[</span><span class="s1">&#39;OutputValue&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">o</span><span class="p">[</span><span class="s1">&#39;OutputKey&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PredictLambdaFunctionARN&#39;</span><span class="p">:</span>
            <span class="n">lambda_to_model_arn</span> <span class="o">=</span> <span class="n">o</span><span class="p">[</span><span class="s1">&#39;OutputValue&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">o</span><span class="p">[</span><span class="s1">&#39;OutputKey&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PredictLambdaFunctionName&#39;</span><span class="p">:</span>
            <span class="n">predict_lambda_name</span> <span class="o">=</span> <span class="n">o</span><span class="p">[</span><span class="s1">&#39;OutputValue&#39;</span><span class="p">]</span>

<span class="k">except</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;CloudFormation stack </span><span class="si">{</span><span class="n">STACK_NAME</span><span class="si">}</span><span class="s1"> was not found. Please set the STACK_NAME properly and re-run this cell&#39;</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;lambda_to_model_arn: </span><span class="si">{</span><span class="n">lambda_to_model_arn</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;lambda_to_fs_arn: </span><span class="si">{</span><span class="n">lambda_to_fs_arn</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;predict_lambda_name: </span><span class="si">{</span><span class="n">predict_lambda_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lambda_to_model_arn: arn:aws:lambda:us-east-1:082830052325:function:HeidelbergInvokeFraudEndpointLambda3
lambda_to_fs_arn: arn:aws:lambda:us-east-1:082830052325:function:HeidelbergStreamingIngestAggFeatures3
predict_lambda_name: HeidelbergInvokeFraudEndpointLambda3
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">store</span> lambda_to_model_arn
<span class="o">%</span><span class="k">store</span> predict_lambda_name
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Stored &#39;lambda_to_model_arn&#39; (str)
Stored &#39;predict_lambda_name&#39; (str)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-feature-groups">Create feature groups<a class="anchor-link" href="#Create-feature-groups"> </a></h2><p>When using Amazon SageMaker Feature Store, a core design decision is the definition of feature groups.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">dateutil.parser</span> <span class="k">as</span> <span class="nn">parser</span>


<span class="k">def</span> <span class="nf">create_feature_group_from_s3_input</span><span class="p">(</span><span class="n">s3_bucket</span><span class="p">,</span> <span class="n">s3_prefix</span><span class="p">,</span> <span class="n">s3_filename</span><span class="p">,</span> <span class="n">fg_name</span><span class="p">,</span> <span class="n">record_identifier_name</span><span class="p">,</span> <span class="n">event_time_feature_name</span><span class="p">,</span><span class="n">role_arn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">s3_uri</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">Object</span><span class="p">(</span><span class="n">s3_bucket</span><span class="p">,</span> <span class="n">s3_prefix</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">s3_filename</span><span class="p">)</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">()[</span><span class="s1">&#39;Body&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">body</span><span class="p">))</span>
    <span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="n">feature_store_session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span>
    <span class="n">boto_session</span><span class="o">=</span><span class="n">boto_session</span><span class="p">,</span>
    <span class="n">sagemaker_client</span><span class="o">=</span><span class="n">sm</span><span class="p">,</span>
    <span class="n">sagemaker_featurestore_runtime_client</span><span class="o">=</span><span class="n">smfs_runtime</span>
    <span class="p">)</span>
    
    <span class="n">feature_group_name</span> <span class="o">=</span> <span class="n">fg_name</span>
    <span class="n">feature_group</span> <span class="o">=</span> <span class="n">FeatureGroup</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">feature_group_name</span><span class="p">,</span> <span class="n">sagemaker_session</span><span class="o">=</span><span class="n">feature_store_session</span><span class="p">)</span>
    <span class="n">l</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">feature_group</span><span class="o">.</span><span class="n">load_feature_definitions</span><span class="p">(</span><span class="n">data_frame</span><span class="o">=</span><span class="n">data</span><span class="p">);</span>
    
    <span class="n">s3_uri</span><span class="o">=</span><span class="s2">&quot;s3://</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s3_bucket</span><span class="p">)</span>

    <span class="c1"># specify record_identifier_name and event_time_feature_name</span>
    <span class="n">feature_group</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
        <span class="n">s3_uri</span><span class="o">=</span><span class="n">s3_uri</span><span class="p">,</span>
        <span class="n">record_identifier_name</span><span class="o">=</span><span class="n">record_identifier_name</span><span class="p">,</span>
        <span class="n">event_time_feature_name</span><span class="o">=</span><span class="n">event_time_feature_name</span><span class="p">,</span>
        <span class="n">role_arn</span><span class="o">=</span><span class="n">role</span><span class="p">,</span>
        <span class="n">enable_online_store</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fg_name</span> <span class="o">=</span> <span class="s1">&#39;heidelberg-mlops-fg&#39;</span>
<span class="o">%</span><span class="k">store</span> fg_name
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Stored &#39;fg_name&#39; (str)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Create-feature-groups(if-not-already-Created)">Create feature groups(if not already Created)<a class="anchor-link" href="#Create-feature-groups(if-not-already-Created)"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">create_feature_group_from_s3_input</span><span class="p">(</span><span class="n">s3_bucket</span><span class="p">,</span><span class="n">s3_prefix</span><span class="p">,</span><span class="n">s3_transformed_data_filename</span><span class="p">,</span><span class="n">fg_name</span><span class="p">,</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;event_time&#39;</span><span class="p">,</span><span class="n">role</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Show-that-the-feature-store-is-aware-of-the-new-feature-groups">Show that the feature store is aware of the new feature groups<a class="anchor-link" href="#Show-that-the-feature-store-is-aware-of-the-new-feature-groups"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sm</span><span class="o">.</span><span class="n">list_feature_groups</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;FeatureGroupSummaries&#39;: [{&#39;FeatureGroupName&#39;: &#39;transaction-feature-group-15-05-22-59&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/transaction-feature-group-15-05-22-59&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2020, 12, 15, 5, 23, 10, 113000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Created&#39;,
   &#39;OfflineStoreStatus&#39;: {&#39;Status&#39;: &#39;Active&#39;}},
  {&#39;FeatureGroupName&#39;: &#39;ml-ops-2&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/ml-ops-2&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2020, 12, 19, 6, 49, 19, 335000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Created&#39;},
  {&#39;FeatureGroupName&#39;: &#39;ml-ops-1&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/ml-ops-1&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2020, 12, 18, 7, 7, 15, 38000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Created&#39;},
  {&#39;FeatureGroupName&#39;: &#39;identity-feature-group-15-05-22-59&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/identity-feature-group-15-05-22-59&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2020, 12, 15, 5, 23, 7, 513000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Created&#39;,
   &#39;OfflineStoreStatus&#39;: {&#39;Status&#39;: &#39;Active&#39;}},
  {&#39;FeatureGroupName&#39;: &#39;heidelberg-mlops-fg-test1&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/heidelberg-mlops-fg-test1&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2020, 12, 30, 6, 41, 36, 615000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Created&#39;},
  {&#39;FeatureGroupName&#39;: &#39;heidelberg-mlops-fg&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/heidelberg-mlops-fg&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2021, 1, 5, 17, 49, 57, 235000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Creating&#39;},
  {&#39;FeatureGroupName&#39;: &#39;heidelberg-fg-test2&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/heidelberg-fg-test2&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2020, 12, 29, 9, 18, 2, 298000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Created&#39;},
  {&#39;FeatureGroupName&#39;: &#39;heidelberg-fg-test&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/heidelberg-fg-test&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2020, 12, 29, 8, 57, 48, 782000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Created&#39;},
  {&#39;FeatureGroupName&#39;: &#39;demo-feature-group-2&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/demo-feature-group-2&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2020, 12, 29, 4, 56, 13, 540000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Created&#39;},
  {&#39;FeatureGroupName&#39;: &#39;demo-feature-group&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/demo-feature-group&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2020, 12, 28, 6, 17, 12, 601000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Created&#39;}],
 &#39;NextToken&#39;: &#39;cIws2QhTXUIa8bi8XYNGwqMND6lavWZ6uZcw9539cUOD10M54amsd7l7yk4ucGW0YBYA+27e3qBpT0v/9eeXaZHI0OynQP0MGWxQIEMxEgPAFTlgHQc4BCc2dClH5/oyLuP4y3HU1Uc+hOt7PjxjfX85eToHqu60szYdvyQww5AIcHO98C+c6aArPfKWA9At4vupqSH+tFFjELqIHIc4VppahmW2c4V08+Ih3icbhVTdkJqtxW32ij3UaIEmXVj2ewAC85aPdqMp6PHmaua2EO6cdfewvaM4/TDk1kXkJblj4Un+QvQlTqL5q5HpO1LGfU5HIKxZNaoe3bC/szFmTTELP1QnIafcIPijnSvnTmHuytOw/Nk8pEhlABQ8yNBEQvy6Rh0cwxasIJdvzO/THM/8QwFTHXtTwp24StY+widOwWlh0SqGCdR/8UxYEFQEUZ3t4fi08RtBh8aQeWYadbd8IwJv6rLl4yUhEZM4KKxVoHI/B5Ge/Sg4Lf3Pq9wK3nS3QowfTbCLYj8CLs6tfvTfAQ==&#39;,
 &#39;ResponseMetadata&#39;: {&#39;RequestId&#39;: &#39;369ebf64-ba06-4364-a38f-acb13ba54739&#39;,
  &#39;HTTPStatusCode&#39;: 200,
  &#39;HTTPHeaders&#39;: {&#39;x-amzn-requestid&#39;: &#39;369ebf64-ba06-4364-a38f-acb13ba54739&#39;,
   &#39;content-type&#39;: &#39;application/x-amz-json-1.1&#39;,
   &#39;content-length&#39;: &#39;2706&#39;,
   &#39;date&#39;: &#39;Tue, 05 Jan 2021 17:49:59 GMT&#39;},
  &#39;RetryAttempts&#39;: 0}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Describe-each-feature-group">Describe each feature group<a class="anchor-link" href="#Describe-each-feature-group"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sm</span><span class="o">.</span><span class="n">describe_feature_group</span><span class="p">(</span><span class="n">FeatureGroupName</span><span class="o">=</span><span class="n">fg_name</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/heidelberg-mlops-fg&#39;,
 &#39;FeatureGroupName&#39;: &#39;heidelberg-mlops-fg&#39;,
 &#39;RecordIdentifierFeatureName&#39;: &#39;id&#39;,
 &#39;EventTimeFeatureName&#39;: &#39;event_time&#39;,
 &#39;FeatureDefinitions&#39;: [{&#39;FeatureName&#39;: &#39;kst_brutto&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;sm&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;tm&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;cl&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;so3&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;k2o&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;na2o&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;south_kiln_feed_01om886__tph__avg&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;south_kiln_feed_01om886__tph__max&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;north_kiln_feed_01om885__tph__avg&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;north_kiln_feed_01om885__tph__max&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;north_fan_speed_01oa943__rpm__avg&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;north_fan_speed_01oa943__rpm__max&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;south_fan_speed_02oa943__rpm__avg&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;south_fan_speed_02oa943__rpm__max&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;lignite_main_burner_03sk820__tph__avg&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;lignite_main_burner_03sk820__tph__max&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;bpg_main_burner_03bf810__tph__avg&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;bpg_main_burner_03bf810__tph__max&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;lignite_calciner_02sk820__tph__avg&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;lignite_calciner_02sk820__tph__max&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;bpg_calciner_02bf810__tph__avg&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;bpg_calciner_02bf810__tph__max&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;kbs_calciner_00kb950__tph__avg&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;kbs_calciner_00kb950__tph__max&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_energy_to_main_burner__gj_h__avg_0&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_energy_to_main_burner__gj_h__max_0&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_energy_to_main_burner__gj_h__avg_1&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_energy_to_main_burner__gj_h__max_1&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_energy_to_main_burner__gj_h__avg_2&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_energy_to_main_burner__gj_h__max_2&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_energy_to_main_burner__gj_h__avg_3&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_energy_to_main_burner__gj_h__max_3&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_energy_to_calciner__gj_h__avg_0&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_energy_to_calciner__gj_h__max_0&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_energy_to_calciner__gj_h__avg_1&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_energy_to_calciner__gj_h__max_1&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_energy_to_calciner__gj_h__avg_2&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_energy_to_calciner__gj_h__max_2&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_energy_to_calciner__gj_h__avg_3&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_energy_to_calciner__gj_h__max_3&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;tf__traditional_fuel__avg&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;tf__traditional_fuel__max&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;af__alternative_fuel__avg&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;af__alternative_fuel__max&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;shc__gj__t_kiln_feed__avg&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;shc__gj__t_kiln_feed__max&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_0&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__max_0&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_1&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__max_1&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_2&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__max_2&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_3&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__max_3&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;co_concentration_in_kiln_inlet_00oa981__ppm__avg&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;co_concentration_in_kiln_inlet_00oa981__ppm__max&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;o2_concentration_in_kiln_inlet_00oa982_____avg&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;o2_concentration_in_kiln_inlet_00oa982_____max&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;bottom_cyclone_gas_temperature_00oa800___c___avg&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;bottom_cyclone_gas_temperature_00oa800___c___max&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;secondary_air_temperature_01kk827___c___avg_0&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;secondary_air_temperature_01kk827___c___max_0&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;secondary_air_temperature_01kk827___c___avg_1&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;secondary_air_temperature_01kk827___c___max_1&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;secondary_air_temperature_01kk827___c___avg_2&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;secondary_air_temperature_01kk827___c___max_2&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;secondary_air_temperature_01kk827___c___avg_3&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;secondary_air_temperature_01kk827___c___max_3&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;tertiary_air_temperature_01kb801___c___avg_0&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;tertiary_air_temperature_01kb801___c___max_0&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;tertiary_air_temperature_01kb801___c___avg_1&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;tertiary_air_temperature_01kb801___c___max_1&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;tertiary_air_temperature_01kb801___c___avg_2&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;tertiary_air_temperature_01kb801___c___max_2&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;tertiary_air_temperature_01kb801___c___avg_3&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;tertiary_air_temperature_01kb801___c___max_3&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;kiln_amps_01do812__amps__avg_0&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;kiln_amps_01do812__amps__max_0&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;kiln_amps_01do812__amps__avg_1&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;kiln_amps_01do812__amps__max_1&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;kiln_amps_01do812__amps__avg_2&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;kiln_amps_01do812__amps__max_2&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;kiln_amps_01do812__amps__avg_3&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;kiln_amps_01do812__amps__max_3&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;co_bottom_cyclone_north_00oa941__amps__avg&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;co_bottom_cyclone_north_00oa941__amps__max&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;o2_bottom_cyclone_north_00oa942_____avg_0&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;o2_bottom_cyclone_north_00oa942_____max_0&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;o2_bottom_cyclone_north_00oa942_____avg_1&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;o2_bottom_cyclone_north_00oa942_____max_1&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;o2_bottom_cyclone_north_00oa942_____avg_2&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;o2_bottom_cyclone_north_00oa942_____max_2&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;o2_bottom_cyclone_north_00oa942_____avg_3&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;o2_bottom_cyclone_north_00oa942_____max_3&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;kiln_speed_01do811__rpm__avg&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;kiln_speed_01do811__rpm__max&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;primary_air_amount_01of850__nm3_h___avg&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;primary_air_amount_01of850__nm3_h___max&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;axial_air_pressure_01of811__mbar__avg&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;axial_air_pressure_01of811__mbar__max&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;radial_air_pressure_01of812__mbar__avg&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;radial_air_pressure_01of812__mbar__max&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;central_air_pressure_01of813__mbar__avg&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;central_air_pressure_01of813__mbar__max&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_feed_avg&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_feed_max&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_energy_avg&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;total_energy_max&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;average_fan_speed_avg&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;average_fan_speed_max&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;average_air_temperature_avg&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;average_air_temperature_max&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;kiln_feed_rate_avg&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;kiln_feed_rate_max&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;klinker___nk_c3s_lag_shift&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;klinker___nk_mgo_lag_shift&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;klinker___nk_fe2o3_lag_shift&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;klinker___nk_al2o3_lag_shift&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;klinker___nk_na2o_lag_shift&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;klinker___nk_k2o_lag_shift&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;klinker___nk_cao_lag_shift&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;klinker___nk_sio2_lag_shift&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;heat_of_formation__kcal_kg_clinker__lag_shift&#39;,
   &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;klinker___nk_so3_lag_shift&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;klinker___nk_sm_lag_shift&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;klinker___nk_am_lag_shift&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;klinker___nk_lsf_lag_shift&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;id&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;},
  {&#39;FeatureName&#39;: &#39;event_time&#39;, &#39;FeatureType&#39;: &#39;Fractional&#39;}],
 &#39;CreationTime&#39;: datetime.datetime(2021, 1, 5, 17, 49, 57, 235000, tzinfo=tzlocal()),
 &#39;OnlineStoreConfig&#39;: {&#39;EnableOnlineStore&#39;: True},
 &#39;OfflineStoreConfig&#39;: {&#39;S3StorageConfig&#39;: {&#39;S3Uri&#39;: &#39;s3://sagemaker-us-east-1-082830052325&#39;},
  &#39;DisableGlueTableCreation&#39;: False},
 &#39;RoleArn&#39;: &#39;arn:aws:iam::082830052325:role/MySagemakerRoleHeidelberg3&#39;,
 &#39;FeatureGroupStatus&#39;: &#39;Creating&#39;,
 &#39;ResponseMetadata&#39;: {&#39;RequestId&#39;: &#39;22bc1c77-b973-49c7-a574-debd2aa3ffb8&#39;,
  &#39;HTTPStatusCode&#39;: 200,
  &#39;HTTPHeaders&#39;: {&#39;x-amzn-requestid&#39;: &#39;22bc1c77-b973-49c7-a574-debd2aa3ffb8&#39;,
   &#39;content-type&#39;: &#39;application/x-amz-json-1.1&#39;,
   &#39;content-length&#39;: &#39;11260&#39;,
   &#39;date&#39;: &#39;Tue, 05 Jan 2021 17:50:01 GMT&#39;},
  &#39;RetryAttempts&#39;: 0}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-an-Amazon-Kinesis-Data-Stream">Create an Amazon Kinesis Data Stream<a class="anchor-link" href="#Create-an-Amazon-Kinesis-Data-Stream"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kinesis_client</span><span class="o">.</span><span class="n">create_stream</span><span class="p">(</span><span class="n">StreamName</span><span class="o">=</span><span class="n">STREAM_NAME</span><span class="p">,</span> <span class="n">ShardCount</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;ResponseMetadata&#39;: {&#39;RequestId&#39;: &#39;eb540470-5ef8-75f8-b33a-ad63000d5a46&#39;,
  &#39;HTTPStatusCode&#39;: 200,
  &#39;HTTPHeaders&#39;: {&#39;x-amzn-requestid&#39;: &#39;eb540470-5ef8-75f8-b33a-ad63000d5a46&#39;,
   &#39;x-amz-id-2&#39;: &#39;1aiJ/8+8IRwrKGfUkHHq76P5bGilrC/E/1H2debFOePX6SzYGUx6ZtxUDNb2VhE5GyNx8j4xOI1P5F1eYnSIGhPI9iJZcD0+&#39;,
   &#39;date&#39;: &#39;Tue, 5 Jan 2021 17:50:11 GMT&#39;,
   &#39;content-type&#39;: &#39;application/x-amz-json-1.1&#39;,
   &#39;content-length&#39;: &#39;0&#39;},
  &#39;RetryAttempts&#39;: 0}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kinesis_client</span><span class="o">.</span><span class="n">list_streams</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;StreamNames&#39;: [&#39;Django-internal-error&#39;,
  &#39;Foo&#39;,
  &#39;cloudcrm-vdr-test&#39;,
  &#39;cloudcrm_pivotal_kinesis_stream&#39;,
  &#39;cn-support-vision-1-article-stream&#39;,
  &#39;cn-support-vision-1-domain-stream&#39;,
  &#39;cn-support-vision-2-dev-Stream&#39;,
  &#39;csv-kba-summary&#39;,
  &#39;heidelberg-mlops-stream&#39;,
  &#39;model-stream&#39;,
  &#39;real-time-analysis&#39;,
  &#39;sococo-video-insights-stream&#39;,
  &#39;solarwind-2-logs-stream&#39;,
  &#39;test-data-stream&#39;,
  &#39;topbox_ingestion_stream&#39;,
  &#39;tu2k20_ashish.gupta1_kinesis&#39;,
  &#39;tu2k20_shivangchopra11&#39;,
  &#39;vdr-eventstream&#39;,
  &#39;viswak-tu2k20&#39;],
 &#39;HasMoreStreams&#39;: False,
 &#39;ResponseMetadata&#39;: {&#39;RequestId&#39;: &#39;e5761aba-a456-6a2f-bd18-b3affaa34591&#39;,
  &#39;HTTPStatusCode&#39;: 200,
  &#39;HTTPHeaders&#39;: {&#39;x-amzn-requestid&#39;: &#39;e5761aba-a456-6a2f-bd18-b3affaa34591&#39;,
   &#39;x-amz-id-2&#39;: &#39;KRaSoOl3qWuLe5kBwOTVAe8xgoI8Opl5Rowgy4Z77+4iE1R0N3C9Rn3alXqYoGqMNgj3qX1ra8mKu4RVzbHLN2BmJjK35P/8&#39;,
   &#39;date&#39;: &#39;Tue, 5 Jan 2021 17:50:13 GMT&#39;,
   &#39;content-type&#39;: &#39;application/x-amz-json-1.1&#39;,
   &#39;content-length&#39;: &#39;502&#39;},
  &#39;RetryAttempts&#39;: 0}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kinesis_client</span><span class="o">.</span><span class="n">describe_stream</span><span class="p">(</span><span class="n">StreamName</span><span class="o">=</span><span class="n">STREAM_NAME</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;StreamDescription&#39;: {&#39;StreamName&#39;: &#39;heidelberg-mlops-stream&#39;,
  &#39;StreamARN&#39;: &#39;arn:aws:kinesis:us-east-1:082830052325:stream/heidelberg-mlops-stream&#39;,
  &#39;StreamStatus&#39;: &#39;CREATING&#39;,
  &#39;Shards&#39;: [],
  &#39;HasMoreShards&#39;: False,
  &#39;RetentionPeriodHours&#39;: 24,
  &#39;StreamCreationTimestamp&#39;: datetime.datetime(2021, 1, 5, 17, 50, 10, tzinfo=tzlocal()),
  &#39;EnhancedMonitoring&#39;: [{&#39;ShardLevelMetrics&#39;: []}],
  &#39;EncryptionType&#39;: &#39;NONE&#39;},
 &#39;ResponseMetadata&#39;: {&#39;RequestId&#39;: &#39;d70a0a13-2cea-0a49-8f64-a305721f25f7&#39;,
  &#39;HTTPStatusCode&#39;: 200,
  &#39;HTTPHeaders&#39;: {&#39;x-amzn-requestid&#39;: &#39;d70a0a13-2cea-0a49-8f64-a305721f25f7&#39;,
   &#39;x-amz-id-2&#39;: &#39;2wHUeiUHaRjrgMJWgiaE+1mFf753aalkJwhrL2yP7djOHoEPJ30owbKhgXB+FdLymwwxupJumKkb9KLfBbRWW2Us8OQiBkjK&#39;,
   &#39;date&#39;: &#39;Tue, 5 Jan 2021 17:50:14 GMT&#39;,
   &#39;content-type&#39;: &#39;application/x-amz-json-1.1&#39;,
   &#39;content-length&#39;: &#39;343&#39;},
  &#39;RetryAttempts&#39;: 0}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="n">active_stream</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">active_stream</span><span class="p">:</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">kinesis_client</span><span class="o">.</span><span class="n">describe_stream</span><span class="p">(</span><span class="n">StreamName</span><span class="o">=</span><span class="n">STREAM_NAME</span><span class="p">)[</span><span class="s1">&#39;StreamDescription&#39;</span><span class="p">][</span><span class="s1">&#39;StreamStatus&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;CREATING&#39;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Waiting for the Kinesis stream to become active...&#39;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>  
    <span class="k">elif</span> <span class="p">(</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;ACTIVE&#39;</span><span class="p">):</span> 
        <span class="n">active_stream</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ACTIVE&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Waiting for the Kinesis stream to become active...
ACTIVE
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stream_arn</span> <span class="o">=</span> <span class="n">kinesis_client</span><span class="o">.</span><span class="n">describe_stream</span><span class="p">(</span><span class="n">StreamName</span><span class="o">=</span><span class="n">STREAM_NAME</span><span class="p">)[</span><span class="s1">&#39;StreamDescription&#39;</span><span class="p">][</span><span class="s1">&#39;StreamARN&#39;</span><span class="p">]</span>
<span class="n">stream_arn</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;arn:aws:kinesis:us-east-1:082830052325:stream/heidelberg-mlops-stream&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Map-the-Kinesis-stream-as-an-event-source-for-Lambda-Model-detection">Map the Kinesis stream as an event source for Lambda Model detection<a class="anchor-link" href="#Map-the-Kinesis-stream-as-an-event-source-for-Lambda-Model-detection"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lambda_client</span><span class="o">.</span><span class="n">create_event_source_mapping</span><span class="p">(</span><span class="n">EventSourceArn</span><span class="o">=</span><span class="n">stream_arn</span><span class="p">,</span>
                                          <span class="n">FunctionName</span><span class="o">=</span><span class="n">lambda_to_model_arn</span><span class="p">,</span>
                                          <span class="n">StartingPosition</span><span class="o">=</span><span class="s1">&#39;LATEST&#39;</span><span class="p">,</span>
                                          <span class="n">Enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                          <span class="n">MaximumRecordAgeInSeconds</span><span class="o">=</span><span class="mi">60</span><span class="o">*</span><span class="mi">10</span>
                                          <span class="p">)</span> 
<span class="c1">#DestinationConfig would handle discarded records</span>
<span class="c1"># write your lambda name here</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;ResponseMetadata&#39;: {&#39;RequestId&#39;: &#39;fb8d00e7-65e8-4433-90da-1b3d1bed683a&#39;,
  &#39;HTTPStatusCode&#39;: 202,
  &#39;HTTPHeaders&#39;: {&#39;date&#39;: &#39;Tue, 05 Jan 2021 17:50:44 GMT&#39;,
   &#39;content-type&#39;: &#39;application/json&#39;,
   &#39;content-length&#39;: &#39;821&#39;,
   &#39;connection&#39;: &#39;keep-alive&#39;,
   &#39;x-amzn-requestid&#39;: &#39;fb8d00e7-65e8-4433-90da-1b3d1bed683a&#39;},
  &#39;RetryAttempts&#39;: 0},
 &#39;UUID&#39;: &#39;9974f2db-2d9a-4081-9e31-7cbb227ca548&#39;,
 &#39;StartingPosition&#39;: &#39;LATEST&#39;,
 &#39;BatchSize&#39;: 100,
 &#39;MaximumBatchingWindowInSeconds&#39;: 0,
 &#39;ParallelizationFactor&#39;: 1,
 &#39;EventSourceArn&#39;: &#39;arn:aws:kinesis:us-east-1:082830052325:stream/heidelberg-mlops-stream&#39;,
 &#39;FunctionArn&#39;: &#39;arn:aws:lambda:us-east-1:082830052325:function:HeidelbergInvokeFraudEndpointLambda3&#39;,
 &#39;LastModified&#39;: datetime.datetime(2021, 1, 5, 17, 50, 44, 109000, tzinfo=tzlocal()),
 &#39;LastProcessingResult&#39;: &#39;No records processed&#39;,
 &#39;State&#39;: &#39;Creating&#39;,
 &#39;StateTransitionReason&#39;: &#39;User action&#39;,
 &#39;DestinationConfig&#39;: {&#39;OnFailure&#39;: {}},
 &#39;MaximumRecordAgeInSeconds&#39;: 600,
 &#39;BisectBatchOnFunctionError&#39;: False,
 &#39;MaximumRetryAttempts&#39;: -1}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-an-Amazon-Kinesis-Data-Applications-(KDA)-application">Create an Amazon Kinesis Data Applications (KDA) application<a class="anchor-link" href="#Create-an-Amazon-Kinesis-Data-Applications-(KDA)-application"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#                 &#39;&quot;cc_num&quot;              BIGINT,\n&#39; + \</span>
<span class="c1">#                 &#39;&quot;num_trans_last_10m&quot;  SMALLINT,\n&#39; + \</span>
<span class="c1">#                 &#39;&quot;avg_amt_last_10m&quot;    REAL\n);\n\n&#39; + \</span>
<span class="c1">#             &#39;CREATE OR REPLACE PUMP &quot;STREAM_PUMP&quot; AS\n&#39; + \</span>
<span class="c1">#             &#39;INSERT INTO &quot;DESTINATION_SQL_STREAM&quot;\n&#39; + \</span>
<span class="c1">#                 &#39;SELECT STREAM &quot;cc_num&quot;, \n&#39; + \</span>
<span class="c1">#                     &#39;COUNT(*) OVER LAST_10_MINUTES, \n&#39; + \</span>
<span class="c1">#                     &#39;AVG(&quot;amount&quot;) OVER LAST_10_MINUTES\n&#39; + \</span>
<span class="c1">#                     &#39;FROM &quot;SOURCE_SQL_STREAM_001&quot;\n&#39; + \</span>
<span class="c1">#                     &#39;WINDOW LAST_10_MINUTES AS (\n&#39; + \</span>
<span class="c1">#                         &#39;PARTITION BY &quot;cc_num&quot;\n&#39; + \</span>
<span class="c1">#                         &#39;RANGE INTERVAL \&#39;10\&#39; MINUTE PRECEDING);\n&#39;</span>
<span class="c1"># print(sql_code_example)</span>



<span class="c1"># sql_code = &quot;&quot;  # Store features from stream to featurestore</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CREATE OR REPLACE STREAM &#34;DESTINATION_SQL_STREAM&#34; (
&#34;cc_num&#34;              BIGINT,
&#34;num_trans_last_10m&#34;  SMALLINT,
&#34;avg_amt_last_10m&#34;    REAL
);

CREATE OR REPLACE PUMP &#34;STREAM_PUMP&#34; AS
INSERT INTO &#34;DESTINATION_SQL_STREAM&#34;
SELECT STREAM &#34;cc_num&#34;, 
COUNT(*) OVER LAST_10_MINUTES, 
AVG(&#34;amount&#34;) OVER LAST_10_MINUTES
FROM &#34;SOURCE_SQL_STREAM_001&#34;
WINDOW LAST_10_MINUTES AS (
PARTITION BY &#34;cc_num&#34;
RANGE INTERVAL &#39;10&#39; MINUTE PRECEDING);

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Application-Code-(SQL-QUERY)-For-KDA">Application Code (SQL QUERY) For KDA<a class="anchor-link" href="#Application-Code-(SQL-QUERY)-For-KDA"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_features</span><span class="p">():</span>
    <span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">Object</span><span class="p">(</span><span class="n">s3_bucket</span><span class="p">,</span> <span class="n">s3_prefix</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">s3_transformed_data_filename</span><span class="p">)</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">()[</span><span class="s1">&#39;Body&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">body</span><span class="p">))</span>
    <span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">features</span> <span class="o">=</span> <span class="n">get_features</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_sql_code</span><span class="p">():</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;CREATE OR REPLACE STREAM &quot;DESTINATION_SQL_STREAM&quot; (</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">index</span><span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">s</span><span class="o">+=</span><span class="s1">&#39;&quot;&#39;</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span><span class="o">+</span><span class="s2">&quot;      REAL,</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span><span class="o">+=</span><span class="s1">&#39;&quot;&#39;</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span><span class="o">+</span><span class="s2">&quot;      REAL</span><span class="se">\n</span><span class="s2">&quot;</span>
            
    <span class="n">s</span><span class="o">+=</span><span class="s1">&#39;); </span><span class="se">\n\n</span><span class="s1">&#39;</span>

    <span class="n">s</span><span class="o">+=</span><span class="s1">&#39;CREATE OR REPLACE PUMP &quot;STREAM_PUMP&quot; AS</span><span class="se">\n</span><span class="s1"> INSERT INTO &quot;DESTINATION_SQL_STREAM&quot;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">s</span><span class="o">+=</span><span class="s1">&#39;SELECT STREAM &#39;</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">index</span><span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">s</span><span class="o">+=</span><span class="s1">&#39;&quot;&#39;</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39;&quot;, </span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span><span class="o">+=</span><span class="s1">&#39;&quot;&#39;</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="s1">&#39;&quot; </span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">s</span><span class="o">+=</span><span class="s1">&#39;FROM &quot;SOURCE_SQL_STREAM_001&quot;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">s</span><span class="o">+=</span><span class="s1">&#39;WINDOW LAST_10_MINUTES AS (</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;PARTITION BY &quot;id&quot;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;RANGE INTERVAL </span><span class="se">\&#39;</span><span class="s1">10</span><span class="se">\&#39;</span><span class="s1"> MINUTE PRECEDING);</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="k">return</span> <span class="n">s</span><span class="p">;</span>

<span class="n">sql_code</span><span class="o">=</span><span class="n">get_sql_code</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sql_code</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CREATE OR REPLACE STREAM &#34;DESTINATION_SQL_STREAM&#34; (
&#34;kst_brutto&#34;      REAL,
&#34;sm&#34;      REAL,
&#34;tm&#34;      REAL,
&#34;cl&#34;      REAL,
&#34;so3&#34;      REAL,
&#34;k2o&#34;      REAL,
&#34;na2o&#34;      REAL,
&#34;south_kiln_feed_01om886__tph__avg&#34;      REAL,
&#34;south_kiln_feed_01om886__tph__max&#34;      REAL,
&#34;north_kiln_feed_01om885__tph__avg&#34;      REAL,
&#34;north_kiln_feed_01om885__tph__max&#34;      REAL,
&#34;north_fan_speed_01oa943__rpm__avg&#34;      REAL,
&#34;north_fan_speed_01oa943__rpm__max&#34;      REAL,
&#34;south_fan_speed_02oa943__rpm__avg&#34;      REAL,
&#34;south_fan_speed_02oa943__rpm__max&#34;      REAL,
&#34;lignite_main_burner_03sk820__tph__avg&#34;      REAL,
&#34;lignite_main_burner_03sk820__tph__max&#34;      REAL,
&#34;bpg_main_burner_03bf810__tph__avg&#34;      REAL,
&#34;bpg_main_burner_03bf810__tph__max&#34;      REAL,
&#34;lignite_calciner_02sk820__tph__avg&#34;      REAL,
&#34;lignite_calciner_02sk820__tph__max&#34;      REAL,
&#34;bpg_calciner_02bf810__tph__avg&#34;      REAL,
&#34;bpg_calciner_02bf810__tph__max&#34;      REAL,
&#34;kbs_calciner_00kb950__tph__avg&#34;      REAL,
&#34;kbs_calciner_00kb950__tph__max&#34;      REAL,
&#34;total_energy_to_main_burner__gj_h__avg_0&#34;      REAL,
&#34;total_energy_to_main_burner__gj_h__max_0&#34;      REAL,
&#34;total_energy_to_main_burner__gj_h__avg_1&#34;      REAL,
&#34;total_energy_to_main_burner__gj_h__max_1&#34;      REAL,
&#34;total_energy_to_main_burner__gj_h__avg_2&#34;      REAL,
&#34;total_energy_to_main_burner__gj_h__max_2&#34;      REAL,
&#34;total_energy_to_main_burner__gj_h__avg_3&#34;      REAL,
&#34;total_energy_to_main_burner__gj_h__max_3&#34;      REAL,
&#34;total_energy_to_calciner__gj_h__avg_0&#34;      REAL,
&#34;total_energy_to_calciner__gj_h__max_0&#34;      REAL,
&#34;total_energy_to_calciner__gj_h__avg_1&#34;      REAL,
&#34;total_energy_to_calciner__gj_h__max_1&#34;      REAL,
&#34;total_energy_to_calciner__gj_h__avg_2&#34;      REAL,
&#34;total_energy_to_calciner__gj_h__max_2&#34;      REAL,
&#34;total_energy_to_calciner__gj_h__avg_3&#34;      REAL,
&#34;total_energy_to_calciner__gj_h__max_3&#34;      REAL,
&#34;tf__traditional_fuel__avg&#34;      REAL,
&#34;tf__traditional_fuel__max&#34;      REAL,
&#34;af__alternative_fuel__avg&#34;      REAL,
&#34;af__alternative_fuel__max&#34;      REAL,
&#34;shc__gj__t_kiln_feed__avg&#34;      REAL,
&#34;shc__gj__t_kiln_feed__max&#34;      REAL,
&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_0&#34;      REAL,
&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__max_0&#34;      REAL,
&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_1&#34;      REAL,
&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__max_1&#34;      REAL,
&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_2&#34;      REAL,
&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__max_2&#34;      REAL,
&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_3&#34;      REAL,
&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__max_3&#34;      REAL,
&#34;co_concentration_in_kiln_inlet_00oa981__ppm__avg&#34;      REAL,
&#34;co_concentration_in_kiln_inlet_00oa981__ppm__max&#34;      REAL,
&#34;o2_concentration_in_kiln_inlet_00oa982_____avg&#34;      REAL,
&#34;o2_concentration_in_kiln_inlet_00oa982_____max&#34;      REAL,
&#34;bottom_cyclone_gas_temperature_00oa800___c___avg&#34;      REAL,
&#34;bottom_cyclone_gas_temperature_00oa800___c___max&#34;      REAL,
&#34;secondary_air_temperature_01kk827___c___avg_0&#34;      REAL,
&#34;secondary_air_temperature_01kk827___c___max_0&#34;      REAL,
&#34;secondary_air_temperature_01kk827___c___avg_1&#34;      REAL,
&#34;secondary_air_temperature_01kk827___c___max_1&#34;      REAL,
&#34;secondary_air_temperature_01kk827___c___avg_2&#34;      REAL,
&#34;secondary_air_temperature_01kk827___c___max_2&#34;      REAL,
&#34;secondary_air_temperature_01kk827___c___avg_3&#34;      REAL,
&#34;secondary_air_temperature_01kk827___c___max_3&#34;      REAL,
&#34;tertiary_air_temperature_01kb801___c___avg_0&#34;      REAL,
&#34;tertiary_air_temperature_01kb801___c___max_0&#34;      REAL,
&#34;tertiary_air_temperature_01kb801___c___avg_1&#34;      REAL,
&#34;tertiary_air_temperature_01kb801___c___max_1&#34;      REAL,
&#34;tertiary_air_temperature_01kb801___c___avg_2&#34;      REAL,
&#34;tertiary_air_temperature_01kb801___c___max_2&#34;      REAL,
&#34;tertiary_air_temperature_01kb801___c___avg_3&#34;      REAL,
&#34;tertiary_air_temperature_01kb801___c___max_3&#34;      REAL,
&#34;kiln_amps_01do812__amps__avg_0&#34;      REAL,
&#34;kiln_amps_01do812__amps__max_0&#34;      REAL,
&#34;kiln_amps_01do812__amps__avg_1&#34;      REAL,
&#34;kiln_amps_01do812__amps__max_1&#34;      REAL,
&#34;kiln_amps_01do812__amps__avg_2&#34;      REAL,
&#34;kiln_amps_01do812__amps__max_2&#34;      REAL,
&#34;kiln_amps_01do812__amps__avg_3&#34;      REAL,
&#34;kiln_amps_01do812__amps__max_3&#34;      REAL,
&#34;co_bottom_cyclone_north_00oa941__amps__avg&#34;      REAL,
&#34;co_bottom_cyclone_north_00oa941__amps__max&#34;      REAL,
&#34;o2_bottom_cyclone_north_00oa942_____avg_0&#34;      REAL,
&#34;o2_bottom_cyclone_north_00oa942_____max_0&#34;      REAL,
&#34;o2_bottom_cyclone_north_00oa942_____avg_1&#34;      REAL,
&#34;o2_bottom_cyclone_north_00oa942_____max_1&#34;      REAL,
&#34;o2_bottom_cyclone_north_00oa942_____avg_2&#34;      REAL,
&#34;o2_bottom_cyclone_north_00oa942_____max_2&#34;      REAL,
&#34;o2_bottom_cyclone_north_00oa942_____avg_3&#34;      REAL,
&#34;o2_bottom_cyclone_north_00oa942_____max_3&#34;      REAL,
&#34;kiln_speed_01do811__rpm__avg&#34;      REAL,
&#34;kiln_speed_01do811__rpm__max&#34;      REAL,
&#34;primary_air_amount_01of850__nm3_h___avg&#34;      REAL,
&#34;primary_air_amount_01of850__nm3_h___max&#34;      REAL,
&#34;axial_air_pressure_01of811__mbar__avg&#34;      REAL,
&#34;axial_air_pressure_01of811__mbar__max&#34;      REAL,
&#34;radial_air_pressure_01of812__mbar__avg&#34;      REAL,
&#34;radial_air_pressure_01of812__mbar__max&#34;      REAL,
&#34;central_air_pressure_01of813__mbar__avg&#34;      REAL,
&#34;central_air_pressure_01of813__mbar__max&#34;      REAL,
&#34;total_feed_avg&#34;      REAL,
&#34;total_feed_max&#34;      REAL,
&#34;total_energy_avg&#34;      REAL,
&#34;total_energy_max&#34;      REAL,
&#34;average_fan_speed_avg&#34;      REAL,
&#34;average_fan_speed_max&#34;      REAL,
&#34;average_air_temperature_avg&#34;      REAL,
&#34;average_air_temperature_max&#34;      REAL,
&#34;kiln_feed_rate_avg&#34;      REAL,
&#34;kiln_feed_rate_max&#34;      REAL,
&#34;klinker___nk_c3s_lag_shift&#34;      REAL,
&#34;klinker___nk_mgo_lag_shift&#34;      REAL,
&#34;klinker___nk_fe2o3_lag_shift&#34;      REAL,
&#34;klinker___nk_al2o3_lag_shift&#34;      REAL,
&#34;klinker___nk_na2o_lag_shift&#34;      REAL,
&#34;klinker___nk_k2o_lag_shift&#34;      REAL,
&#34;klinker___nk_cao_lag_shift&#34;      REAL,
&#34;klinker___nk_sio2_lag_shift&#34;      REAL,
&#34;heat_of_formation__kcal_kg_clinker__lag_shift&#34;      REAL,
&#34;klinker___nk_so3_lag_shift&#34;      REAL,
&#34;klinker___nk_sm_lag_shift&#34;      REAL,
&#34;klinker___nk_am_lag_shift&#34;      REAL,
&#34;klinker___nk_lsf_lag_shift&#34;      REAL,
&#34;id&#34;      REAL,
&#34;event_time&#34;      REAL
); 

CREATE OR REPLACE PUMP &#34;STREAM_PUMP&#34; AS
 INSERT INTO &#34;DESTINATION_SQL_STREAM&#34;
SELECT STREAM &#34;kst_brutto&#34;, 
&#34;sm&#34;, 
&#34;tm&#34;, 
&#34;cl&#34;, 
&#34;so3&#34;, 
&#34;k2o&#34;, 
&#34;na2o&#34;, 
&#34;south_kiln_feed_01om886__tph__avg&#34;, 
&#34;south_kiln_feed_01om886__tph__max&#34;, 
&#34;north_kiln_feed_01om885__tph__avg&#34;, 
&#34;north_kiln_feed_01om885__tph__max&#34;, 
&#34;north_fan_speed_01oa943__rpm__avg&#34;, 
&#34;north_fan_speed_01oa943__rpm__max&#34;, 
&#34;south_fan_speed_02oa943__rpm__avg&#34;, 
&#34;south_fan_speed_02oa943__rpm__max&#34;, 
&#34;lignite_main_burner_03sk820__tph__avg&#34;, 
&#34;lignite_main_burner_03sk820__tph__max&#34;, 
&#34;bpg_main_burner_03bf810__tph__avg&#34;, 
&#34;bpg_main_burner_03bf810__tph__max&#34;, 
&#34;lignite_calciner_02sk820__tph__avg&#34;, 
&#34;lignite_calciner_02sk820__tph__max&#34;, 
&#34;bpg_calciner_02bf810__tph__avg&#34;, 
&#34;bpg_calciner_02bf810__tph__max&#34;, 
&#34;kbs_calciner_00kb950__tph__avg&#34;, 
&#34;kbs_calciner_00kb950__tph__max&#34;, 
&#34;total_energy_to_main_burner__gj_h__avg_0&#34;, 
&#34;total_energy_to_main_burner__gj_h__max_0&#34;, 
&#34;total_energy_to_main_burner__gj_h__avg_1&#34;, 
&#34;total_energy_to_main_burner__gj_h__max_1&#34;, 
&#34;total_energy_to_main_burner__gj_h__avg_2&#34;, 
&#34;total_energy_to_main_burner__gj_h__max_2&#34;, 
&#34;total_energy_to_main_burner__gj_h__avg_3&#34;, 
&#34;total_energy_to_main_burner__gj_h__max_3&#34;, 
&#34;total_energy_to_calciner__gj_h__avg_0&#34;, 
&#34;total_energy_to_calciner__gj_h__max_0&#34;, 
&#34;total_energy_to_calciner__gj_h__avg_1&#34;, 
&#34;total_energy_to_calciner__gj_h__max_1&#34;, 
&#34;total_energy_to_calciner__gj_h__avg_2&#34;, 
&#34;total_energy_to_calciner__gj_h__max_2&#34;, 
&#34;total_energy_to_calciner__gj_h__avg_3&#34;, 
&#34;total_energy_to_calciner__gj_h__max_3&#34;, 
&#34;tf__traditional_fuel__avg&#34;, 
&#34;tf__traditional_fuel__max&#34;, 
&#34;af__alternative_fuel__avg&#34;, 
&#34;af__alternative_fuel__max&#34;, 
&#34;shc__gj__t_kiln_feed__avg&#34;, 
&#34;shc__gj__t_kiln_feed__max&#34;, 
&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_0&#34;, 
&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__max_0&#34;, 
&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_1&#34;, 
&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__max_1&#34;, 
&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_2&#34;, 
&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__max_2&#34;, 
&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_3&#34;, 
&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__max_3&#34;, 
&#34;co_concentration_in_kiln_inlet_00oa981__ppm__avg&#34;, 
&#34;co_concentration_in_kiln_inlet_00oa981__ppm__max&#34;, 
&#34;o2_concentration_in_kiln_inlet_00oa982_____avg&#34;, 
&#34;o2_concentration_in_kiln_inlet_00oa982_____max&#34;, 
&#34;bottom_cyclone_gas_temperature_00oa800___c___avg&#34;, 
&#34;bottom_cyclone_gas_temperature_00oa800___c___max&#34;, 
&#34;secondary_air_temperature_01kk827___c___avg_0&#34;, 
&#34;secondary_air_temperature_01kk827___c___max_0&#34;, 
&#34;secondary_air_temperature_01kk827___c___avg_1&#34;, 
&#34;secondary_air_temperature_01kk827___c___max_1&#34;, 
&#34;secondary_air_temperature_01kk827___c___avg_2&#34;, 
&#34;secondary_air_temperature_01kk827___c___max_2&#34;, 
&#34;secondary_air_temperature_01kk827___c___avg_3&#34;, 
&#34;secondary_air_temperature_01kk827___c___max_3&#34;, 
&#34;tertiary_air_temperature_01kb801___c___avg_0&#34;, 
&#34;tertiary_air_temperature_01kb801___c___max_0&#34;, 
&#34;tertiary_air_temperature_01kb801___c___avg_1&#34;, 
&#34;tertiary_air_temperature_01kb801___c___max_1&#34;, 
&#34;tertiary_air_temperature_01kb801___c___avg_2&#34;, 
&#34;tertiary_air_temperature_01kb801___c___max_2&#34;, 
&#34;tertiary_air_temperature_01kb801___c___avg_3&#34;, 
&#34;tertiary_air_temperature_01kb801___c___max_3&#34;, 
&#34;kiln_amps_01do812__amps__avg_0&#34;, 
&#34;kiln_amps_01do812__amps__max_0&#34;, 
&#34;kiln_amps_01do812__amps__avg_1&#34;, 
&#34;kiln_amps_01do812__amps__max_1&#34;, 
&#34;kiln_amps_01do812__amps__avg_2&#34;, 
&#34;kiln_amps_01do812__amps__max_2&#34;, 
&#34;kiln_amps_01do812__amps__avg_3&#34;, 
&#34;kiln_amps_01do812__amps__max_3&#34;, 
&#34;co_bottom_cyclone_north_00oa941__amps__avg&#34;, 
&#34;co_bottom_cyclone_north_00oa941__amps__max&#34;, 
&#34;o2_bottom_cyclone_north_00oa942_____avg_0&#34;, 
&#34;o2_bottom_cyclone_north_00oa942_____max_0&#34;, 
&#34;o2_bottom_cyclone_north_00oa942_____avg_1&#34;, 
&#34;o2_bottom_cyclone_north_00oa942_____max_1&#34;, 
&#34;o2_bottom_cyclone_north_00oa942_____avg_2&#34;, 
&#34;o2_bottom_cyclone_north_00oa942_____max_2&#34;, 
&#34;o2_bottom_cyclone_north_00oa942_____avg_3&#34;, 
&#34;o2_bottom_cyclone_north_00oa942_____max_3&#34;, 
&#34;kiln_speed_01do811__rpm__avg&#34;, 
&#34;kiln_speed_01do811__rpm__max&#34;, 
&#34;primary_air_amount_01of850__nm3_h___avg&#34;, 
&#34;primary_air_amount_01of850__nm3_h___max&#34;, 
&#34;axial_air_pressure_01of811__mbar__avg&#34;, 
&#34;axial_air_pressure_01of811__mbar__max&#34;, 
&#34;radial_air_pressure_01of812__mbar__avg&#34;, 
&#34;radial_air_pressure_01of812__mbar__max&#34;, 
&#34;central_air_pressure_01of813__mbar__avg&#34;, 
&#34;central_air_pressure_01of813__mbar__max&#34;, 
&#34;total_feed_avg&#34;, 
&#34;total_feed_max&#34;, 
&#34;total_energy_avg&#34;, 
&#34;total_energy_max&#34;, 
&#34;average_fan_speed_avg&#34;, 
&#34;average_fan_speed_max&#34;, 
&#34;average_air_temperature_avg&#34;, 
&#34;average_air_temperature_max&#34;, 
&#34;kiln_feed_rate_avg&#34;, 
&#34;kiln_feed_rate_max&#34;, 
&#34;klinker___nk_c3s_lag_shift&#34;, 
&#34;klinker___nk_mgo_lag_shift&#34;, 
&#34;klinker___nk_fe2o3_lag_shift&#34;, 
&#34;klinker___nk_al2o3_lag_shift&#34;, 
&#34;klinker___nk_na2o_lag_shift&#34;, 
&#34;klinker___nk_k2o_lag_shift&#34;, 
&#34;klinker___nk_cao_lag_shift&#34;, 
&#34;klinker___nk_sio2_lag_shift&#34;, 
&#34;heat_of_formation__kcal_kg_clinker__lag_shift&#34;, 
&#34;klinker___nk_so3_lag_shift&#34;, 
&#34;klinker___nk_sm_lag_shift&#34;, 
&#34;klinker___nk_am_lag_shift&#34;, 
&#34;klinker___nk_lsf_lag_shift&#34;, 
&#34;id&#34;, 
&#34;event_time&#34; 
FROM &#34;SOURCE_SQL_STREAM_001&#34;
WINDOW LAST_10_MINUTES AS (
PARTITION BY &#34;id&#34;
RANGE INTERVAL &#39;10&#39; MINUTE PRECEDING);

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_record_columns</span><span class="p">():</span>
    <span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">Object</span><span class="p">(</span><span class="n">s3_bucket</span><span class="p">,</span> <span class="n">s3_prefix</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">s3_transformed_data_filename</span><span class="p">)</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">()[</span><span class="s1">&#39;Body&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">body</span><span class="p">))</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">record_columns</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">column</span><span class="o">!=</span><span class="s1">&#39;target&#39;</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="n">column</span><span class="p">,</span>  <span class="s1">&#39;Mapping&#39;</span><span class="p">:</span> <span class="s1">&#39;$.&#39;</span><span class="o">+</span><span class="n">column</span><span class="p">,</span>   <span class="s1">&#39;SqlType&#39;</span><span class="p">:</span> <span class="s1">&#39;REAL&#39;</span><span class="p">}</span>
            <span class="n">record_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">record_columns</span>
<span class="n">record_columns</span>  <span class="o">=</span> <span class="n">get_record_columns</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kda_inputs</span> <span class="o">=</span> <span class="p">[{</span>
                <span class="s1">&#39;NamePrefix&#39;</span><span class="p">:</span> <span class="s1">&#39;SOURCE_SQL_STREAM&#39;</span><span class="p">,</span>
                <span class="s1">&#39;KinesisStreamsInput&#39;</span><span class="p">:</span> <span class="p">{</span>
                       <span class="s1">&#39;ResourceARN&#39;</span><span class="p">:</span> <span class="n">stream_arn</span><span class="p">,</span>
                       <span class="s1">&#39;RoleARN&#39;</span><span class="p">:</span> <span class="n">role</span>
                <span class="p">},</span>
                <span class="s1">&#39;InputSchema&#39;</span><span class="p">:</span> <span class="p">{</span>
                      <span class="s1">&#39;RecordFormat&#39;</span><span class="p">:</span> <span class="p">{</span>
                          <span class="s1">&#39;RecordFormatType&#39;</span><span class="p">:</span> <span class="s1">&#39;JSON&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;MappingParameters&#39;</span><span class="p">:</span> <span class="p">{</span>
                              <span class="s1">&#39;JSONMappingParameters&#39;</span><span class="p">:</span> <span class="p">{</span>
                                  <span class="s1">&#39;RecordRowPath&#39;</span><span class="p">:</span> <span class="s1">&#39;$&#39;</span>
                              <span class="p">}</span>
                          <span class="p">},</span>
                      <span class="p">},</span>
                      <span class="s1">&#39;RecordEncoding&#39;</span><span class="p">:</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;RecordColumns&#39;</span><span class="p">:</span> <span class="n">record_columns</span>
                <span class="p">}</span>
              <span class="p">}</span>                         
             <span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3> Create Kinesis Data Analytics Application </h3><p>We first lookup Lambda ARNs from CloudFormation output, then create a Kinesis Data Analytics application that connects its output to the Streaming Lambda. This Lambda will ingest the records and write them to the SageMaker Feature Group.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kda_outputs</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;LambdaOutput&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ResourceARN&#39;</span><span class="p">:</span> <span class="n">lambda_to_fs_arn</span><span class="p">,</span> <span class="s1">&#39;RoleARN&#39;</span><span class="p">:</span> <span class="n">role</span><span class="p">},</span>
                <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;DESTINATION_SQL_STREAM&#39;</span><span class="p">,</span>
                <span class="s1">&#39;DestinationSchema&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;RecordFormatType&#39;</span><span class="p">:</span> <span class="s1">&#39;JSON&#39;</span><span class="p">}}]</span>
<span class="n">kda_outputs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;LambdaOutput&#39;: {&#39;ResourceARN&#39;: &#39;arn:aws:lambda:us-east-1:082830052325:function:HeidelbergStreamingIngestAggFeatures3&#39;,
   &#39;RoleARN&#39;: &#39;arn:aws:iam::082830052325:role/MySagemakerRoleHeidelberg3&#39;},
  &#39;Name&#39;: &#39;DESTINATION_SQL_STREAM&#39;,
  &#39;DestinationSchema&#39;: {&#39;RecordFormatType&#39;: &#39;JSON&#39;}}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kda_client</span><span class="o">.</span><span class="n">create_application</span><span class="p">(</span><span class="n">ApplicationName</span><span class="o">=</span><span class="n">APPLICATION_NAME</span><span class="p">,</span> 
                              <span class="n">Inputs</span><span class="o">=</span><span class="n">kda_inputs</span><span class="p">,</span>
                              <span class="n">Outputs</span><span class="o">=</span><span class="n">kda_outputs</span><span class="p">,</span>
                              <span class="n">ApplicationCode</span><span class="o">=</span><span class="n">sql_code</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;ApplicationSummary&#39;: {&#39;ApplicationName&#39;: &#39;heidelberg-mlops-app&#39;,
  &#39;ApplicationARN&#39;: &#39;arn:aws:kinesisanalytics:us-east-1:082830052325:application/heidelberg-mlops-app&#39;,
  &#39;ApplicationStatus&#39;: &#39;READY&#39;},
 &#39;ResponseMetadata&#39;: {&#39;RequestId&#39;: &#39;d2eb591b-650e-4c3a-acb7-737c98783b23&#39;,
  &#39;HTTPStatusCode&#39;: 200,
  &#39;HTTPHeaders&#39;: {&#39;x-amzn-requestid&#39;: &#39;d2eb591b-650e-4c3a-acb7-737c98783b23&#39;,
   &#39;content-type&#39;: &#39;application/x-amz-json-1.1&#39;,
   &#39;content-length&#39;: &#39;193&#39;,
   &#39;date&#39;: &#39;Tue, 05 Jan 2021 17:51:13 GMT&#39;},
  &#39;RetryAttempts&#39;: 0}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kda_client</span><span class="o">.</span><span class="n">describe_application</span><span class="p">(</span><span class="n">ApplicationName</span><span class="o">=</span><span class="n">APPLICATION_NAME</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;ApplicationDetail&#39;: {&#39;ApplicationName&#39;: &#39;heidelberg-mlops-app&#39;,
  &#39;ApplicationARN&#39;: &#39;arn:aws:kinesisanalytics:us-east-1:082830052325:application/heidelberg-mlops-app&#39;,
  &#39;ApplicationStatus&#39;: &#39;READY&#39;,
  &#39;CreateTimestamp&#39;: datetime.datetime(2021, 1, 5, 17, 51, 14, tzinfo=tzlocal()),
  &#39;LastUpdateTimestamp&#39;: datetime.datetime(2021, 1, 5, 17, 51, 14, tzinfo=tzlocal()),
  &#39;InputDescriptions&#39;: [{&#39;InputId&#39;: &#39;1.1&#39;,
    &#39;NamePrefix&#39;: &#39;SOURCE_SQL_STREAM&#39;,
    &#39;InAppStreamNames&#39;: [&#39;SOURCE_SQL_STREAM_001&#39;],
    &#39;KinesisStreamsInputDescription&#39;: {&#39;ResourceARN&#39;: &#39;arn:aws:kinesis:us-east-1:082830052325:stream/heidelberg-mlops-stream&#39;,
     &#39;RoleARN&#39;: &#39;arn:aws:iam::082830052325:role/MySagemakerRoleHeidelberg3&#39;},
    &#39;InputSchema&#39;: {&#39;RecordFormat&#39;: {&#39;RecordFormatType&#39;: &#39;JSON&#39;,
      &#39;MappingParameters&#39;: {&#39;JSONMappingParameters&#39;: {&#39;RecordRowPath&#39;: &#39;$&#39;}}},
     &#39;RecordEncoding&#39;: &#39;UTF-8&#39;,
     &#39;RecordColumns&#39;: [{&#39;Name&#39;: &#39;kst_brutto&#39;,
       &#39;Mapping&#39;: &#39;$.kst_brutto&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;sm&#39;, &#39;Mapping&#39;: &#39;$.sm&#39;, &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;tm&#39;, &#39;Mapping&#39;: &#39;$.tm&#39;, &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;cl&#39;, &#39;Mapping&#39;: &#39;$.cl&#39;, &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;so3&#39;, &#39;Mapping&#39;: &#39;$.so3&#39;, &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;k2o&#39;, &#39;Mapping&#39;: &#39;$.k2o&#39;, &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;na2o&#39;, &#39;Mapping&#39;: &#39;$.na2o&#39;, &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;south_kiln_feed_01om886__tph__avg&#39;,
       &#39;Mapping&#39;: &#39;$.south_kiln_feed_01om886__tph__avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;south_kiln_feed_01om886__tph__max&#39;,
       &#39;Mapping&#39;: &#39;$.south_kiln_feed_01om886__tph__max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;north_kiln_feed_01om885__tph__avg&#39;,
       &#39;Mapping&#39;: &#39;$.north_kiln_feed_01om885__tph__avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;north_kiln_feed_01om885__tph__max&#39;,
       &#39;Mapping&#39;: &#39;$.north_kiln_feed_01om885__tph__max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;north_fan_speed_01oa943__rpm__avg&#39;,
       &#39;Mapping&#39;: &#39;$.north_fan_speed_01oa943__rpm__avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;north_fan_speed_01oa943__rpm__max&#39;,
       &#39;Mapping&#39;: &#39;$.north_fan_speed_01oa943__rpm__max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;south_fan_speed_02oa943__rpm__avg&#39;,
       &#39;Mapping&#39;: &#39;$.south_fan_speed_02oa943__rpm__avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;south_fan_speed_02oa943__rpm__max&#39;,
       &#39;Mapping&#39;: &#39;$.south_fan_speed_02oa943__rpm__max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;lignite_main_burner_03sk820__tph__avg&#39;,
       &#39;Mapping&#39;: &#39;$.lignite_main_burner_03sk820__tph__avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;lignite_main_burner_03sk820__tph__max&#39;,
       &#39;Mapping&#39;: &#39;$.lignite_main_burner_03sk820__tph__max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;bpg_main_burner_03bf810__tph__avg&#39;,
       &#39;Mapping&#39;: &#39;$.bpg_main_burner_03bf810__tph__avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;bpg_main_burner_03bf810__tph__max&#39;,
       &#39;Mapping&#39;: &#39;$.bpg_main_burner_03bf810__tph__max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;lignite_calciner_02sk820__tph__avg&#39;,
       &#39;Mapping&#39;: &#39;$.lignite_calciner_02sk820__tph__avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;lignite_calciner_02sk820__tph__max&#39;,
       &#39;Mapping&#39;: &#39;$.lignite_calciner_02sk820__tph__max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;bpg_calciner_02bf810__tph__avg&#39;,
       &#39;Mapping&#39;: &#39;$.bpg_calciner_02bf810__tph__avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;bpg_calciner_02bf810__tph__max&#39;,
       &#39;Mapping&#39;: &#39;$.bpg_calciner_02bf810__tph__max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;kbs_calciner_00kb950__tph__avg&#39;,
       &#39;Mapping&#39;: &#39;$.kbs_calciner_00kb950__tph__avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;kbs_calciner_00kb950__tph__max&#39;,
       &#39;Mapping&#39;: &#39;$.kbs_calciner_00kb950__tph__max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_energy_to_main_burner__gj_h__avg_0&#39;,
       &#39;Mapping&#39;: &#39;$.total_energy_to_main_burner__gj_h__avg_0&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_energy_to_main_burner__gj_h__max_0&#39;,
       &#39;Mapping&#39;: &#39;$.total_energy_to_main_burner__gj_h__max_0&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_energy_to_main_burner__gj_h__avg_1&#39;,
       &#39;Mapping&#39;: &#39;$.total_energy_to_main_burner__gj_h__avg_1&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_energy_to_main_burner__gj_h__max_1&#39;,
       &#39;Mapping&#39;: &#39;$.total_energy_to_main_burner__gj_h__max_1&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_energy_to_main_burner__gj_h__avg_2&#39;,
       &#39;Mapping&#39;: &#39;$.total_energy_to_main_burner__gj_h__avg_2&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_energy_to_main_burner__gj_h__max_2&#39;,
       &#39;Mapping&#39;: &#39;$.total_energy_to_main_burner__gj_h__max_2&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_energy_to_main_burner__gj_h__avg_3&#39;,
       &#39;Mapping&#39;: &#39;$.total_energy_to_main_burner__gj_h__avg_3&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_energy_to_main_burner__gj_h__max_3&#39;,
       &#39;Mapping&#39;: &#39;$.total_energy_to_main_burner__gj_h__max_3&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_energy_to_calciner__gj_h__avg_0&#39;,
       &#39;Mapping&#39;: &#39;$.total_energy_to_calciner__gj_h__avg_0&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_energy_to_calciner__gj_h__max_0&#39;,
       &#39;Mapping&#39;: &#39;$.total_energy_to_calciner__gj_h__max_0&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_energy_to_calciner__gj_h__avg_1&#39;,
       &#39;Mapping&#39;: &#39;$.total_energy_to_calciner__gj_h__avg_1&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_energy_to_calciner__gj_h__max_1&#39;,
       &#39;Mapping&#39;: &#39;$.total_energy_to_calciner__gj_h__max_1&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_energy_to_calciner__gj_h__avg_2&#39;,
       &#39;Mapping&#39;: &#39;$.total_energy_to_calciner__gj_h__avg_2&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_energy_to_calciner__gj_h__max_2&#39;,
       &#39;Mapping&#39;: &#39;$.total_energy_to_calciner__gj_h__max_2&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_energy_to_calciner__gj_h__avg_3&#39;,
       &#39;Mapping&#39;: &#39;$.total_energy_to_calciner__gj_h__avg_3&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_energy_to_calciner__gj_h__max_3&#39;,
       &#39;Mapping&#39;: &#39;$.total_energy_to_calciner__gj_h__max_3&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;tf__traditional_fuel__avg&#39;,
       &#39;Mapping&#39;: &#39;$.tf__traditional_fuel__avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;tf__traditional_fuel__max&#39;,
       &#39;Mapping&#39;: &#39;$.tf__traditional_fuel__max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;af__alternative_fuel__avg&#39;,
       &#39;Mapping&#39;: &#39;$.af__alternative_fuel__avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;af__alternative_fuel__max&#39;,
       &#39;Mapping&#39;: &#39;$.af__alternative_fuel__max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;shc__gj__t_kiln_feed__avg&#39;,
       &#39;Mapping&#39;: &#39;$.shc__gj__t_kiln_feed__avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;shc__gj__t_kiln_feed__max&#39;,
       &#39;Mapping&#39;: &#39;$.shc__gj__t_kiln_feed__max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_0&#39;,
       &#39;Mapping&#39;: &#39;$.nox_concentration_in_kiln_inlet_00oa983__ppm__avg_0&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__max_0&#39;,
       &#39;Mapping&#39;: &#39;$.nox_concentration_in_kiln_inlet_00oa983__ppm__max_0&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_1&#39;,
       &#39;Mapping&#39;: &#39;$.nox_concentration_in_kiln_inlet_00oa983__ppm__avg_1&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__max_1&#39;,
       &#39;Mapping&#39;: &#39;$.nox_concentration_in_kiln_inlet_00oa983__ppm__max_1&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_2&#39;,
       &#39;Mapping&#39;: &#39;$.nox_concentration_in_kiln_inlet_00oa983__ppm__avg_2&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__max_2&#39;,
       &#39;Mapping&#39;: &#39;$.nox_concentration_in_kiln_inlet_00oa983__ppm__max_2&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_3&#39;,
       &#39;Mapping&#39;: &#39;$.nox_concentration_in_kiln_inlet_00oa983__ppm__avg_3&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;nox_concentration_in_kiln_inlet_00oa983__ppm__max_3&#39;,
       &#39;Mapping&#39;: &#39;$.nox_concentration_in_kiln_inlet_00oa983__ppm__max_3&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;co_concentration_in_kiln_inlet_00oa981__ppm__avg&#39;,
       &#39;Mapping&#39;: &#39;$.co_concentration_in_kiln_inlet_00oa981__ppm__avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;co_concentration_in_kiln_inlet_00oa981__ppm__max&#39;,
       &#39;Mapping&#39;: &#39;$.co_concentration_in_kiln_inlet_00oa981__ppm__max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;o2_concentration_in_kiln_inlet_00oa982_____avg&#39;,
       &#39;Mapping&#39;: &#39;$.o2_concentration_in_kiln_inlet_00oa982_____avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;o2_concentration_in_kiln_inlet_00oa982_____max&#39;,
       &#39;Mapping&#39;: &#39;$.o2_concentration_in_kiln_inlet_00oa982_____max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;bottom_cyclone_gas_temperature_00oa800___c___avg&#39;,
       &#39;Mapping&#39;: &#39;$.bottom_cyclone_gas_temperature_00oa800___c___avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;bottom_cyclone_gas_temperature_00oa800___c___max&#39;,
       &#39;Mapping&#39;: &#39;$.bottom_cyclone_gas_temperature_00oa800___c___max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;secondary_air_temperature_01kk827___c___avg_0&#39;,
       &#39;Mapping&#39;: &#39;$.secondary_air_temperature_01kk827___c___avg_0&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;secondary_air_temperature_01kk827___c___max_0&#39;,
       &#39;Mapping&#39;: &#39;$.secondary_air_temperature_01kk827___c___max_0&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;secondary_air_temperature_01kk827___c___avg_1&#39;,
       &#39;Mapping&#39;: &#39;$.secondary_air_temperature_01kk827___c___avg_1&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;secondary_air_temperature_01kk827___c___max_1&#39;,
       &#39;Mapping&#39;: &#39;$.secondary_air_temperature_01kk827___c___max_1&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;secondary_air_temperature_01kk827___c___avg_2&#39;,
       &#39;Mapping&#39;: &#39;$.secondary_air_temperature_01kk827___c___avg_2&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;secondary_air_temperature_01kk827___c___max_2&#39;,
       &#39;Mapping&#39;: &#39;$.secondary_air_temperature_01kk827___c___max_2&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;secondary_air_temperature_01kk827___c___avg_3&#39;,
       &#39;Mapping&#39;: &#39;$.secondary_air_temperature_01kk827___c___avg_3&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;secondary_air_temperature_01kk827___c___max_3&#39;,
       &#39;Mapping&#39;: &#39;$.secondary_air_temperature_01kk827___c___max_3&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;tertiary_air_temperature_01kb801___c___avg_0&#39;,
       &#39;Mapping&#39;: &#39;$.tertiary_air_temperature_01kb801___c___avg_0&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;tertiary_air_temperature_01kb801___c___max_0&#39;,
       &#39;Mapping&#39;: &#39;$.tertiary_air_temperature_01kb801___c___max_0&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;tertiary_air_temperature_01kb801___c___avg_1&#39;,
       &#39;Mapping&#39;: &#39;$.tertiary_air_temperature_01kb801___c___avg_1&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;tertiary_air_temperature_01kb801___c___max_1&#39;,
       &#39;Mapping&#39;: &#39;$.tertiary_air_temperature_01kb801___c___max_1&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;tertiary_air_temperature_01kb801___c___avg_2&#39;,
       &#39;Mapping&#39;: &#39;$.tertiary_air_temperature_01kb801___c___avg_2&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;tertiary_air_temperature_01kb801___c___max_2&#39;,
       &#39;Mapping&#39;: &#39;$.tertiary_air_temperature_01kb801___c___max_2&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;tertiary_air_temperature_01kb801___c___avg_3&#39;,
       &#39;Mapping&#39;: &#39;$.tertiary_air_temperature_01kb801___c___avg_3&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;tertiary_air_temperature_01kb801___c___max_3&#39;,
       &#39;Mapping&#39;: &#39;$.tertiary_air_temperature_01kb801___c___max_3&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;kiln_amps_01do812__amps__avg_0&#39;,
       &#39;Mapping&#39;: &#39;$.kiln_amps_01do812__amps__avg_0&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;kiln_amps_01do812__amps__max_0&#39;,
       &#39;Mapping&#39;: &#39;$.kiln_amps_01do812__amps__max_0&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;kiln_amps_01do812__amps__avg_1&#39;,
       &#39;Mapping&#39;: &#39;$.kiln_amps_01do812__amps__avg_1&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;kiln_amps_01do812__amps__max_1&#39;,
       &#39;Mapping&#39;: &#39;$.kiln_amps_01do812__amps__max_1&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;kiln_amps_01do812__amps__avg_2&#39;,
       &#39;Mapping&#39;: &#39;$.kiln_amps_01do812__amps__avg_2&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;kiln_amps_01do812__amps__max_2&#39;,
       &#39;Mapping&#39;: &#39;$.kiln_amps_01do812__amps__max_2&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;kiln_amps_01do812__amps__avg_3&#39;,
       &#39;Mapping&#39;: &#39;$.kiln_amps_01do812__amps__avg_3&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;kiln_amps_01do812__amps__max_3&#39;,
       &#39;Mapping&#39;: &#39;$.kiln_amps_01do812__amps__max_3&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;co_bottom_cyclone_north_00oa941__amps__avg&#39;,
       &#39;Mapping&#39;: &#39;$.co_bottom_cyclone_north_00oa941__amps__avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;co_bottom_cyclone_north_00oa941__amps__max&#39;,
       &#39;Mapping&#39;: &#39;$.co_bottom_cyclone_north_00oa941__amps__max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;o2_bottom_cyclone_north_00oa942_____avg_0&#39;,
       &#39;Mapping&#39;: &#39;$.o2_bottom_cyclone_north_00oa942_____avg_0&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;o2_bottom_cyclone_north_00oa942_____max_0&#39;,
       &#39;Mapping&#39;: &#39;$.o2_bottom_cyclone_north_00oa942_____max_0&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;o2_bottom_cyclone_north_00oa942_____avg_1&#39;,
       &#39;Mapping&#39;: &#39;$.o2_bottom_cyclone_north_00oa942_____avg_1&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;o2_bottom_cyclone_north_00oa942_____max_1&#39;,
       &#39;Mapping&#39;: &#39;$.o2_bottom_cyclone_north_00oa942_____max_1&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;o2_bottom_cyclone_north_00oa942_____avg_2&#39;,
       &#39;Mapping&#39;: &#39;$.o2_bottom_cyclone_north_00oa942_____avg_2&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;o2_bottom_cyclone_north_00oa942_____max_2&#39;,
       &#39;Mapping&#39;: &#39;$.o2_bottom_cyclone_north_00oa942_____max_2&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;o2_bottom_cyclone_north_00oa942_____avg_3&#39;,
       &#39;Mapping&#39;: &#39;$.o2_bottom_cyclone_north_00oa942_____avg_3&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;o2_bottom_cyclone_north_00oa942_____max_3&#39;,
       &#39;Mapping&#39;: &#39;$.o2_bottom_cyclone_north_00oa942_____max_3&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;kiln_speed_01do811__rpm__avg&#39;,
       &#39;Mapping&#39;: &#39;$.kiln_speed_01do811__rpm__avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;kiln_speed_01do811__rpm__max&#39;,
       &#39;Mapping&#39;: &#39;$.kiln_speed_01do811__rpm__max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;primary_air_amount_01of850__nm3_h___avg&#39;,
       &#39;Mapping&#39;: &#39;$.primary_air_amount_01of850__nm3_h___avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;primary_air_amount_01of850__nm3_h___max&#39;,
       &#39;Mapping&#39;: &#39;$.primary_air_amount_01of850__nm3_h___max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;axial_air_pressure_01of811__mbar__avg&#39;,
       &#39;Mapping&#39;: &#39;$.axial_air_pressure_01of811__mbar__avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;axial_air_pressure_01of811__mbar__max&#39;,
       &#39;Mapping&#39;: &#39;$.axial_air_pressure_01of811__mbar__max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;radial_air_pressure_01of812__mbar__avg&#39;,
       &#39;Mapping&#39;: &#39;$.radial_air_pressure_01of812__mbar__avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;radial_air_pressure_01of812__mbar__max&#39;,
       &#39;Mapping&#39;: &#39;$.radial_air_pressure_01of812__mbar__max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;central_air_pressure_01of813__mbar__avg&#39;,
       &#39;Mapping&#39;: &#39;$.central_air_pressure_01of813__mbar__avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;central_air_pressure_01of813__mbar__max&#39;,
       &#39;Mapping&#39;: &#39;$.central_air_pressure_01of813__mbar__max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_feed_avg&#39;,
       &#39;Mapping&#39;: &#39;$.total_feed_avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_feed_max&#39;,
       &#39;Mapping&#39;: &#39;$.total_feed_max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_energy_avg&#39;,
       &#39;Mapping&#39;: &#39;$.total_energy_avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;total_energy_max&#39;,
       &#39;Mapping&#39;: &#39;$.total_energy_max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;average_fan_speed_avg&#39;,
       &#39;Mapping&#39;: &#39;$.average_fan_speed_avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;average_fan_speed_max&#39;,
       &#39;Mapping&#39;: &#39;$.average_fan_speed_max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;average_air_temperature_avg&#39;,
       &#39;Mapping&#39;: &#39;$.average_air_temperature_avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;average_air_temperature_max&#39;,
       &#39;Mapping&#39;: &#39;$.average_air_temperature_max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;kiln_feed_rate_avg&#39;,
       &#39;Mapping&#39;: &#39;$.kiln_feed_rate_avg&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;kiln_feed_rate_max&#39;,
       &#39;Mapping&#39;: &#39;$.kiln_feed_rate_max&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;klinker___nk_c3s_lag_shift&#39;,
       &#39;Mapping&#39;: &#39;$.klinker___nk_c3s_lag_shift&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;klinker___nk_mgo_lag_shift&#39;,
       &#39;Mapping&#39;: &#39;$.klinker___nk_mgo_lag_shift&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;klinker___nk_fe2o3_lag_shift&#39;,
       &#39;Mapping&#39;: &#39;$.klinker___nk_fe2o3_lag_shift&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;klinker___nk_al2o3_lag_shift&#39;,
       &#39;Mapping&#39;: &#39;$.klinker___nk_al2o3_lag_shift&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;klinker___nk_na2o_lag_shift&#39;,
       &#39;Mapping&#39;: &#39;$.klinker___nk_na2o_lag_shift&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;klinker___nk_k2o_lag_shift&#39;,
       &#39;Mapping&#39;: &#39;$.klinker___nk_k2o_lag_shift&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;klinker___nk_cao_lag_shift&#39;,
       &#39;Mapping&#39;: &#39;$.klinker___nk_cao_lag_shift&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;klinker___nk_sio2_lag_shift&#39;,
       &#39;Mapping&#39;: &#39;$.klinker___nk_sio2_lag_shift&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;heat_of_formation__kcal_kg_clinker__lag_shift&#39;,
       &#39;Mapping&#39;: &#39;$.heat_of_formation__kcal_kg_clinker__lag_shift&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;klinker___nk_so3_lag_shift&#39;,
       &#39;Mapping&#39;: &#39;$.klinker___nk_so3_lag_shift&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;klinker___nk_sm_lag_shift&#39;,
       &#39;Mapping&#39;: &#39;$.klinker___nk_sm_lag_shift&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;klinker___nk_am_lag_shift&#39;,
       &#39;Mapping&#39;: &#39;$.klinker___nk_am_lag_shift&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;klinker___nk_lsf_lag_shift&#39;,
       &#39;Mapping&#39;: &#39;$.klinker___nk_lsf_lag_shift&#39;,
       &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;id&#39;, &#39;Mapping&#39;: &#39;$.id&#39;, &#39;SqlType&#39;: &#39;REAL&#39;},
      {&#39;Name&#39;: &#39;event_time&#39;, &#39;Mapping&#39;: &#39;$.event_time&#39;, &#39;SqlType&#39;: &#39;REAL&#39;}]},
    &#39;InputParallelism&#39;: {&#39;Count&#39;: 1},
    &#39;InputStartingPositionConfiguration&#39;: {}}],
  &#39;OutputDescriptions&#39;: [{&#39;OutputId&#39;: &#39;1.1&#39;,
    &#39;Name&#39;: &#39;DESTINATION_SQL_STREAM&#39;,
    &#39;LambdaOutputDescription&#39;: {&#39;ResourceARN&#39;: &#39;arn:aws:lambda:us-east-1:082830052325:function:HeidelbergStreamingIngestAggFeatures3&#39;,
     &#39;RoleARN&#39;: &#39;arn:aws:iam::082830052325:role/MySagemakerRoleHeidelberg3&#39;},
    &#39;DestinationSchema&#39;: {&#39;RecordFormatType&#39;: &#39;JSON&#39;}}],
  &#39;ApplicationCode&#39;: &#39;CREATE OR REPLACE STREAM &#34;DESTINATION_SQL_STREAM&#34; (\n&#34;kst_brutto&#34;      REAL,\n&#34;sm&#34;      REAL,\n&#34;tm&#34;      REAL,\n&#34;cl&#34;      REAL,\n&#34;so3&#34;      REAL,\n&#34;k2o&#34;      REAL,\n&#34;na2o&#34;      REAL,\n&#34;south_kiln_feed_01om886__tph__avg&#34;      REAL,\n&#34;south_kiln_feed_01om886__tph__max&#34;      REAL,\n&#34;north_kiln_feed_01om885__tph__avg&#34;      REAL,\n&#34;north_kiln_feed_01om885__tph__max&#34;      REAL,\n&#34;north_fan_speed_01oa943__rpm__avg&#34;      REAL,\n&#34;north_fan_speed_01oa943__rpm__max&#34;      REAL,\n&#34;south_fan_speed_02oa943__rpm__avg&#34;      REAL,\n&#34;south_fan_speed_02oa943__rpm__max&#34;      REAL,\n&#34;lignite_main_burner_03sk820__tph__avg&#34;      REAL,\n&#34;lignite_main_burner_03sk820__tph__max&#34;      REAL,\n&#34;bpg_main_burner_03bf810__tph__avg&#34;      REAL,\n&#34;bpg_main_burner_03bf810__tph__max&#34;      REAL,\n&#34;lignite_calciner_02sk820__tph__avg&#34;      REAL,\n&#34;lignite_calciner_02sk820__tph__max&#34;      REAL,\n&#34;bpg_calciner_02bf810__tph__avg&#34;      REAL,\n&#34;bpg_calciner_02bf810__tph__max&#34;      REAL,\n&#34;kbs_calciner_00kb950__tph__avg&#34;      REAL,\n&#34;kbs_calciner_00kb950__tph__max&#34;      REAL,\n&#34;total_energy_to_main_burner__gj_h__avg_0&#34;      REAL,\n&#34;total_energy_to_main_burner__gj_h__max_0&#34;      REAL,\n&#34;total_energy_to_main_burner__gj_h__avg_1&#34;      REAL,\n&#34;total_energy_to_main_burner__gj_h__max_1&#34;      REAL,\n&#34;total_energy_to_main_burner__gj_h__avg_2&#34;      REAL,\n&#34;total_energy_to_main_burner__gj_h__max_2&#34;      REAL,\n&#34;total_energy_to_main_burner__gj_h__avg_3&#34;      REAL,\n&#34;total_energy_to_main_burner__gj_h__max_3&#34;      REAL,\n&#34;total_energy_to_calciner__gj_h__avg_0&#34;      REAL,\n&#34;total_energy_to_calciner__gj_h__max_0&#34;      REAL,\n&#34;total_energy_to_calciner__gj_h__avg_1&#34;      REAL,\n&#34;total_energy_to_calciner__gj_h__max_1&#34;      REAL,\n&#34;total_energy_to_calciner__gj_h__avg_2&#34;      REAL,\n&#34;total_energy_to_calciner__gj_h__max_2&#34;      REAL,\n&#34;total_energy_to_calciner__gj_h__avg_3&#34;      REAL,\n&#34;total_energy_to_calciner__gj_h__max_3&#34;      REAL,\n&#34;tf__traditional_fuel__avg&#34;      REAL,\n&#34;tf__traditional_fuel__max&#34;      REAL,\n&#34;af__alternative_fuel__avg&#34;      REAL,\n&#34;af__alternative_fuel__max&#34;      REAL,\n&#34;shc__gj__t_kiln_feed__avg&#34;      REAL,\n&#34;shc__gj__t_kiln_feed__max&#34;      REAL,\n&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_0&#34;      REAL,\n&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__max_0&#34;      REAL,\n&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_1&#34;      REAL,\n&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__max_1&#34;      REAL,\n&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_2&#34;      REAL,\n&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__max_2&#34;      REAL,\n&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_3&#34;      REAL,\n&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__max_3&#34;      REAL,\n&#34;co_concentration_in_kiln_inlet_00oa981__ppm__avg&#34;      REAL,\n&#34;co_concentration_in_kiln_inlet_00oa981__ppm__max&#34;      REAL,\n&#34;o2_concentration_in_kiln_inlet_00oa982_____avg&#34;      REAL,\n&#34;o2_concentration_in_kiln_inlet_00oa982_____max&#34;      REAL,\n&#34;bottom_cyclone_gas_temperature_00oa800___c___avg&#34;      REAL,\n&#34;bottom_cyclone_gas_temperature_00oa800___c___max&#34;      REAL,\n&#34;secondary_air_temperature_01kk827___c___avg_0&#34;      REAL,\n&#34;secondary_air_temperature_01kk827___c___max_0&#34;      REAL,\n&#34;secondary_air_temperature_01kk827___c___avg_1&#34;      REAL,\n&#34;secondary_air_temperature_01kk827___c___max_1&#34;      REAL,\n&#34;secondary_air_temperature_01kk827___c___avg_2&#34;      REAL,\n&#34;secondary_air_temperature_01kk827___c___max_2&#34;      REAL,\n&#34;secondary_air_temperature_01kk827___c___avg_3&#34;      REAL,\n&#34;secondary_air_temperature_01kk827___c___max_3&#34;      REAL,\n&#34;tertiary_air_temperature_01kb801___c___avg_0&#34;      REAL,\n&#34;tertiary_air_temperature_01kb801___c___max_0&#34;      REAL,\n&#34;tertiary_air_temperature_01kb801___c___avg_1&#34;      REAL,\n&#34;tertiary_air_temperature_01kb801___c___max_1&#34;      REAL,\n&#34;tertiary_air_temperature_01kb801___c___avg_2&#34;      REAL,\n&#34;tertiary_air_temperature_01kb801___c___max_2&#34;      REAL,\n&#34;tertiary_air_temperature_01kb801___c___avg_3&#34;      REAL,\n&#34;tertiary_air_temperature_01kb801___c___max_3&#34;      REAL,\n&#34;kiln_amps_01do812__amps__avg_0&#34;      REAL,\n&#34;kiln_amps_01do812__amps__max_0&#34;      REAL,\n&#34;kiln_amps_01do812__amps__avg_1&#34;      REAL,\n&#34;kiln_amps_01do812__amps__max_1&#34;      REAL,\n&#34;kiln_amps_01do812__amps__avg_2&#34;      REAL,\n&#34;kiln_amps_01do812__amps__max_2&#34;      REAL,\n&#34;kiln_amps_01do812__amps__avg_3&#34;      REAL,\n&#34;kiln_amps_01do812__amps__max_3&#34;      REAL,\n&#34;co_bottom_cyclone_north_00oa941__amps__avg&#34;      REAL,\n&#34;co_bottom_cyclone_north_00oa941__amps__max&#34;      REAL,\n&#34;o2_bottom_cyclone_north_00oa942_____avg_0&#34;      REAL,\n&#34;o2_bottom_cyclone_north_00oa942_____max_0&#34;      REAL,\n&#34;o2_bottom_cyclone_north_00oa942_____avg_1&#34;      REAL,\n&#34;o2_bottom_cyclone_north_00oa942_____max_1&#34;      REAL,\n&#34;o2_bottom_cyclone_north_00oa942_____avg_2&#34;      REAL,\n&#34;o2_bottom_cyclone_north_00oa942_____max_2&#34;      REAL,\n&#34;o2_bottom_cyclone_north_00oa942_____avg_3&#34;      REAL,\n&#34;o2_bottom_cyclone_north_00oa942_____max_3&#34;      REAL,\n&#34;kiln_speed_01do811__rpm__avg&#34;      REAL,\n&#34;kiln_speed_01do811__rpm__max&#34;      REAL,\n&#34;primary_air_amount_01of850__nm3_h___avg&#34;      REAL,\n&#34;primary_air_amount_01of850__nm3_h___max&#34;      REAL,\n&#34;axial_air_pressure_01of811__mbar__avg&#34;      REAL,\n&#34;axial_air_pressure_01of811__mbar__max&#34;      REAL,\n&#34;radial_air_pressure_01of812__mbar__avg&#34;      REAL,\n&#34;radial_air_pressure_01of812__mbar__max&#34;      REAL,\n&#34;central_air_pressure_01of813__mbar__avg&#34;      REAL,\n&#34;central_air_pressure_01of813__mbar__max&#34;      REAL,\n&#34;total_feed_avg&#34;      REAL,\n&#34;total_feed_max&#34;      REAL,\n&#34;total_energy_avg&#34;      REAL,\n&#34;total_energy_max&#34;      REAL,\n&#34;average_fan_speed_avg&#34;      REAL,\n&#34;average_fan_speed_max&#34;      REAL,\n&#34;average_air_temperature_avg&#34;      REAL,\n&#34;average_air_temperature_max&#34;      REAL,\n&#34;kiln_feed_rate_avg&#34;      REAL,\n&#34;kiln_feed_rate_max&#34;      REAL,\n&#34;klinker___nk_c3s_lag_shift&#34;      REAL,\n&#34;klinker___nk_mgo_lag_shift&#34;      REAL,\n&#34;klinker___nk_fe2o3_lag_shift&#34;      REAL,\n&#34;klinker___nk_al2o3_lag_shift&#34;      REAL,\n&#34;klinker___nk_na2o_lag_shift&#34;      REAL,\n&#34;klinker___nk_k2o_lag_shift&#34;      REAL,\n&#34;klinker___nk_cao_lag_shift&#34;      REAL,\n&#34;klinker___nk_sio2_lag_shift&#34;      REAL,\n&#34;heat_of_formation__kcal_kg_clinker__lag_shift&#34;      REAL,\n&#34;klinker___nk_so3_lag_shift&#34;      REAL,\n&#34;klinker___nk_sm_lag_shift&#34;      REAL,\n&#34;klinker___nk_am_lag_shift&#34;      REAL,\n&#34;klinker___nk_lsf_lag_shift&#34;      REAL,\n&#34;id&#34;      REAL,\n&#34;event_time&#34;      REAL\n); \n\nCREATE OR REPLACE PUMP &#34;STREAM_PUMP&#34; AS\n INSERT INTO &#34;DESTINATION_SQL_STREAM&#34;\nSELECT STREAM &#34;kst_brutto&#34;, \n&#34;sm&#34;, \n&#34;tm&#34;, \n&#34;cl&#34;, \n&#34;so3&#34;, \n&#34;k2o&#34;, \n&#34;na2o&#34;, \n&#34;south_kiln_feed_01om886__tph__avg&#34;, \n&#34;south_kiln_feed_01om886__tph__max&#34;, \n&#34;north_kiln_feed_01om885__tph__avg&#34;, \n&#34;north_kiln_feed_01om885__tph__max&#34;, \n&#34;north_fan_speed_01oa943__rpm__avg&#34;, \n&#34;north_fan_speed_01oa943__rpm__max&#34;, \n&#34;south_fan_speed_02oa943__rpm__avg&#34;, \n&#34;south_fan_speed_02oa943__rpm__max&#34;, \n&#34;lignite_main_burner_03sk820__tph__avg&#34;, \n&#34;lignite_main_burner_03sk820__tph__max&#34;, \n&#34;bpg_main_burner_03bf810__tph__avg&#34;, \n&#34;bpg_main_burner_03bf810__tph__max&#34;, \n&#34;lignite_calciner_02sk820__tph__avg&#34;, \n&#34;lignite_calciner_02sk820__tph__max&#34;, \n&#34;bpg_calciner_02bf810__tph__avg&#34;, \n&#34;bpg_calciner_02bf810__tph__max&#34;, \n&#34;kbs_calciner_00kb950__tph__avg&#34;, \n&#34;kbs_calciner_00kb950__tph__max&#34;, \n&#34;total_energy_to_main_burner__gj_h__avg_0&#34;, \n&#34;total_energy_to_main_burner__gj_h__max_0&#34;, \n&#34;total_energy_to_main_burner__gj_h__avg_1&#34;, \n&#34;total_energy_to_main_burner__gj_h__max_1&#34;, \n&#34;total_energy_to_main_burner__gj_h__avg_2&#34;, \n&#34;total_energy_to_main_burner__gj_h__max_2&#34;, \n&#34;total_energy_to_main_burner__gj_h__avg_3&#34;, \n&#34;total_energy_to_main_burner__gj_h__max_3&#34;, \n&#34;total_energy_to_calciner__gj_h__avg_0&#34;, \n&#34;total_energy_to_calciner__gj_h__max_0&#34;, \n&#34;total_energy_to_calciner__gj_h__avg_1&#34;, \n&#34;total_energy_to_calciner__gj_h__max_1&#34;, \n&#34;total_energy_to_calciner__gj_h__avg_2&#34;, \n&#34;total_energy_to_calciner__gj_h__max_2&#34;, \n&#34;total_energy_to_calciner__gj_h__avg_3&#34;, \n&#34;total_energy_to_calciner__gj_h__max_3&#34;, \n&#34;tf__traditional_fuel__avg&#34;, \n&#34;tf__traditional_fuel__max&#34;, \n&#34;af__alternative_fuel__avg&#34;, \n&#34;af__alternative_fuel__max&#34;, \n&#34;shc__gj__t_kiln_feed__avg&#34;, \n&#34;shc__gj__t_kiln_feed__max&#34;, \n&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_0&#34;, \n&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__max_0&#34;, \n&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_1&#34;, \n&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__max_1&#34;, \n&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_2&#34;, \n&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__max_2&#34;, \n&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__avg_3&#34;, \n&#34;nox_concentration_in_kiln_inlet_00oa983__ppm__max_3&#34;, \n&#34;co_concentration_in_kiln_inlet_00oa981__ppm__avg&#34;, \n&#34;co_concentration_in_kiln_inlet_00oa981__ppm__max&#34;, \n&#34;o2_concentration_in_kiln_inlet_00oa982_____avg&#34;, \n&#34;o2_concentration_in_kiln_inlet_00oa982_____max&#34;, \n&#34;bottom_cyclone_gas_temperature_00oa800___c___avg&#34;, \n&#34;bottom_cyclone_gas_temperature_00oa800___c___max&#34;, \n&#34;secondary_air_temperature_01kk827___c___avg_0&#34;, \n&#34;secondary_air_temperature_01kk827___c___max_0&#34;, \n&#34;secondary_air_temperature_01kk827___c___avg_1&#34;, \n&#34;secondary_air_temperature_01kk827___c___max_1&#34;, \n&#34;secondary_air_temperature_01kk827___c___avg_2&#34;, \n&#34;secondary_air_temperature_01kk827___c___max_2&#34;, \n&#34;secondary_air_temperature_01kk827___c___avg_3&#34;, \n&#34;secondary_air_temperature_01kk827___c___max_3&#34;, \n&#34;tertiary_air_temperature_01kb801___c___avg_0&#34;, \n&#34;tertiary_air_temperature_01kb801___c___max_0&#34;, \n&#34;tertiary_air_temperature_01kb801___c___avg_1&#34;, \n&#34;tertiary_air_temperature_01kb801___c___max_1&#34;, \n&#34;tertiary_air_temperature_01kb801___c___avg_2&#34;, \n&#34;tertiary_air_temperature_01kb801___c___max_2&#34;, \n&#34;tertiary_air_temperature_01kb801___c___avg_3&#34;, \n&#34;tertiary_air_temperature_01kb801___c___max_3&#34;, \n&#34;kiln_amps_01do812__amps__avg_0&#34;, \n&#34;kiln_amps_01do812__amps__max_0&#34;, \n&#34;kiln_amps_01do812__amps__avg_1&#34;, \n&#34;kiln_amps_01do812__amps__max_1&#34;, \n&#34;kiln_amps_01do812__amps__avg_2&#34;, \n&#34;kiln_amps_01do812__amps__max_2&#34;, \n&#34;kiln_amps_01do812__amps__avg_3&#34;, \n&#34;kiln_amps_01do812__amps__max_3&#34;, \n&#34;co_bottom_cyclone_north_00oa941__amps__avg&#34;, \n&#34;co_bottom_cyclone_north_00oa941__amps__max&#34;, \n&#34;o2_bottom_cyclone_north_00oa942_____avg_0&#34;, \n&#34;o2_bottom_cyclone_north_00oa942_____max_0&#34;, \n&#34;o2_bottom_cyclone_north_00oa942_____avg_1&#34;, \n&#34;o2_bottom_cyclone_north_00oa942_____max_1&#34;, \n&#34;o2_bottom_cyclone_north_00oa942_____avg_2&#34;, \n&#34;o2_bottom_cyclone_north_00oa942_____max_2&#34;, \n&#34;o2_bottom_cyclone_north_00oa942_____avg_3&#34;, \n&#34;o2_bottom_cyclone_north_00oa942_____max_3&#34;, \n&#34;kiln_speed_01do811__rpm__avg&#34;, \n&#34;kiln_speed_01do811__rpm__max&#34;, \n&#34;primary_air_amount_01of850__nm3_h___avg&#34;, \n&#34;primary_air_amount_01of850__nm3_h___max&#34;, \n&#34;axial_air_pressure_01of811__mbar__avg&#34;, \n&#34;axial_air_pressure_01of811__mbar__max&#34;, \n&#34;radial_air_pressure_01of812__mbar__avg&#34;, \n&#34;radial_air_pressure_01of812__mbar__max&#34;, \n&#34;central_air_pressure_01of813__mbar__avg&#34;, \n&#34;central_air_pressure_01of813__mbar__max&#34;, \n&#34;total_feed_avg&#34;, \n&#34;total_feed_max&#34;, \n&#34;total_energy_avg&#34;, \n&#34;total_energy_max&#34;, \n&#34;average_fan_speed_avg&#34;, \n&#34;average_fan_speed_max&#34;, \n&#34;average_air_temperature_avg&#34;, \n&#34;average_air_temperature_max&#34;, \n&#34;kiln_feed_rate_avg&#34;, \n&#34;kiln_feed_rate_max&#34;, \n&#34;klinker___nk_c3s_lag_shift&#34;, \n&#34;klinker___nk_mgo_lag_shift&#34;, \n&#34;klinker___nk_fe2o3_lag_shift&#34;, \n&#34;klinker___nk_al2o3_lag_shift&#34;, \n&#34;klinker___nk_na2o_lag_shift&#34;, \n&#34;klinker___nk_k2o_lag_shift&#34;, \n&#34;klinker___nk_cao_lag_shift&#34;, \n&#34;klinker___nk_sio2_lag_shift&#34;, \n&#34;heat_of_formation__kcal_kg_clinker__lag_shift&#34;, \n&#34;klinker___nk_so3_lag_shift&#34;, \n&#34;klinker___nk_sm_lag_shift&#34;, \n&#34;klinker___nk_am_lag_shift&#34;, \n&#34;klinker___nk_lsf_lag_shift&#34;, \n&#34;id&#34;, \n&#34;event_time&#34; \nFROM &#34;SOURCE_SQL_STREAM_001&#34;\nWINDOW LAST_10_MINUTES AS (\nPARTITION BY &#34;id&#34;\nRANGE INTERVAL \&#39;10\&#39; MINUTE PRECEDING);\n&#39;,
  &#39;ApplicationVersionId&#39;: 1},
 &#39;ResponseMetadata&#39;: {&#39;RequestId&#39;: &#39;e0e7f7e5-17ee-45ab-85d2-e6f03c16948a&#39;,
  &#39;HTTPStatusCode&#39;: 200,
  &#39;HTTPHeaders&#39;: {&#39;x-amzn-requestid&#39;: &#39;e0e7f7e5-17ee-45ab-85d2-e6f03c16948a&#39;,
   &#39;content-type&#39;: &#39;application/x-amz-json-1.1&#39;,
   &#39;content-length&#39;: &#39;27895&#39;,
   &#39;date&#39;: &#39;Tue, 05 Jan 2021 17:51:15 GMT&#39;},
  &#39;RetryAttempts&#39;: 0}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kda_client</span><span class="o">.</span><span class="n">start_application</span><span class="p">(</span><span class="n">ApplicationName</span><span class="o">=</span><span class="n">APPLICATION_NAME</span><span class="p">,</span>
                             <span class="n">InputConfigurations</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;Id&#39;</span><span class="p">:</span> <span class="s1">&#39;1.1&#39;</span><span class="p">,</span>
                                                   <span class="s1">&#39;InputStartingPositionConfiguration&#39;</span><span class="p">:</span> 
                                                     <span class="p">{</span><span class="s1">&#39;InputStartingPosition&#39;</span><span class="p">:</span><span class="s1">&#39;NOW&#39;</span><span class="p">}}])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;ResponseMetadata&#39;: {&#39;RequestId&#39;: &#39;65d9eecd-8466-4fcb-8de5-88a6d0369662&#39;,
  &#39;HTTPStatusCode&#39;: 200,
  &#39;HTTPHeaders&#39;: {&#39;x-amzn-requestid&#39;: &#39;65d9eecd-8466-4fcb-8de5-88a6d0369662&#39;,
   &#39;content-type&#39;: &#39;application/x-amz-json-1.1&#39;,
   &#39;content-length&#39;: &#39;2&#39;,
   &#39;date&#39;: &#39;Tue, 05 Jan 2021 17:51:22 GMT&#39;},
  &#39;RetryAttempts&#39;: 0}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Training-and-Deploying-the-Model">Training and Deploying the Model<a class="anchor-link" href="#Training-and-Deploying-the-Model"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="1.-Train-and-Deploy-the-model-(Hyperparameter-Training)">1. Train and Deploy the model (Hyperparameter Training)<a class="anchor-link" href="#1.-Train-and-Deploy-the-model-(Hyperparameter-Training)"> </a></h4><h4 id="2.-Get-the-endpoint-of-deployed-model">2. Get the endpoint of deployed model<a class="anchor-link" href="#2.-Get-the-endpoint-of-deployed-model"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Split-the-data-in-train-and-val-and-train-the-model-using-XGBOOST">Split the data in train and val and train the model using XGBOOST<a class="anchor-link" href="#Split-the-data-in-train-and-val-and-train-the-model-using-XGBOOST"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">s3</span><span class="o">.</span><span class="n">Object</span><span class="p">(</span><span class="n">s3_bucket</span><span class="p">,</span><span class="n">s3_prefix</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">s3_transformed_data_filename</span> <span class="p">)</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">()[</span><span class="s1">&#39;Body&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">body</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">train</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">train</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;train.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">val</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;val.csv&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>aws s3 cp train.csv s3://<span class="o">{</span>s3_bucket<span class="o">}</span>/<span class="o">{</span>s3_prefix<span class="o">}</span>/
<span class="o">!</span>aws s3 cp val.csv s3://<span class="o">{</span>s3_bucket<span class="o">}</span>/<span class="o">{</span>s3_prefix<span class="o">}</span>/
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>upload: ./train.csv to s3://sagemaker-us-east-1-082830052325/heidelberg/data/train.csv
upload: ./val.csv to s3://sagemaker-us-east-1-082830052325/heidelberg/data/val.csv
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sagemaker.inputs</span> <span class="kn">import</span> <span class="n">TrainingInput</span>

<span class="c1"># initialize hyperparameters</span>
<span class="n">hyperparameters</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;max_depth&quot;</span><span class="p">:</span><span class="s2">&quot;5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;eta&quot;</span><span class="p">:</span><span class="s2">&quot;0.2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gamma&quot;</span><span class="p">:</span><span class="s2">&quot;4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;min_child_weight&quot;</span><span class="p">:</span><span class="s2">&quot;6&quot;</span><span class="p">,</span>
        <span class="s2">&quot;subsample&quot;</span><span class="p">:</span><span class="s2">&quot;0.7&quot;</span><span class="p">,</span>
        <span class="s2">&quot;objective&quot;</span><span class="p">:</span><span class="s2">&quot;reg:linear&quot;</span><span class="p">,</span>
        <span class="s2">&quot;num_round&quot;</span><span class="p">:</span><span class="s2">&quot;100&quot;</span><span class="p">}</span>

<span class="n">output_path</span> <span class="o">=</span> <span class="s1">&#39;s3://</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">/output&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s3_bucket</span><span class="p">,</span> <span class="n">s3_prefix</span><span class="p">)</span>

<span class="c1"># this line automatically looks for the XGBoost image URI and builds an XGBoost container.</span>
<span class="c1"># specify the repo_version depending on your preference.</span>
<span class="n">xgboost_container</span> <span class="o">=</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">image_uris</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="s2">&quot;xgboost&quot;</span><span class="p">,</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span><span class="o">.</span><span class="n">boto_region_name</span><span class="p">,</span> <span class="s2">&quot;1.2-1&quot;</span><span class="p">)</span>

<span class="c1"># construct a SageMaker estimator that calls the xgboost-container</span>
<span class="n">estimator</span> <span class="o">=</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">Estimator</span><span class="p">(</span><span class="n">image_uri</span><span class="o">=</span><span class="n">xgboost_container</span><span class="p">,</span> 
                                          <span class="n">hyperparameters</span><span class="o">=</span><span class="n">hyperparameters</span><span class="p">,</span>
                                          <span class="n">role</span><span class="o">=</span><span class="n">sagemaker</span><span class="o">.</span><span class="n">get_execution_role</span><span class="p">(),</span>
                                          <span class="n">instance_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                          <span class="n">instance_type</span><span class="o">=</span><span class="s1">&#39;ml.m5.2xlarge&#39;</span><span class="p">,</span> 
                                          <span class="n">volume_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="c1"># 5 GB </span>
                                          <span class="n">output_path</span><span class="o">=</span><span class="n">output_path</span><span class="p">)</span>

<span class="c1"># define the data type and paths to the training and validation datasets</span>
<span class="n">content_type</span> <span class="o">=</span> <span class="s2">&quot;csv&quot;</span>
<span class="n">train_input</span> <span class="o">=</span> <span class="n">TrainingInput</span><span class="p">(</span><span class="s2">&quot;s3://</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s3_bucket</span><span class="p">,</span> <span class="n">s3_prefix</span><span class="p">,</span> <span class="s1">&#39;train.csv&#39;</span><span class="p">),</span> <span class="n">content_type</span><span class="o">=</span><span class="n">content_type</span><span class="p">)</span>
<span class="n">validation_input</span> <span class="o">=</span> <span class="n">TrainingInput</span><span class="p">(</span><span class="s2">&quot;s3://</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s3_bucket</span><span class="p">,</span> <span class="n">s3_prefix</span><span class="p">,</span> <span class="s1">&#39;val.csv&#39;</span><span class="p">),</span> <span class="n">content_type</span><span class="o">=</span><span class="n">content_type</span><span class="p">)</span>

<span class="c1"># execute the XGBoost training job</span>
<span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">({</span><span class="s1">&#39;train&#39;</span><span class="p">:</span> <span class="n">train_input</span><span class="p">,</span> <span class="s1">&#39;validation&#39;</span><span class="p">:</span> <span class="n">validation_input</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-01-05 17:52:09 Starting - Starting the training job...
2021-01-05 17:52:35 Starting - Launching requested ML instancesProfilerReport-1609869129: InProgress
......
2021-01-05 17:53:36 Starting - Preparing the instances for training...
2021-01-05 17:54:05 Downloading - Downloading input data...
2021-01-05 17:54:38 Training - Training image download completed. Training in progress..<span class="ansi-blue-fg">INFO:sagemaker-containers:Imported framework sagemaker_xgboost_container.training</span>
<span class="ansi-blue-fg">INFO:sagemaker-containers:Failed to parse hyperparameter objective value reg:linear to Json.</span>
<span class="ansi-blue-fg">Returning the value itself</span>
<span class="ansi-blue-fg">INFO:sagemaker-containers:No GPUs detected (normal if no gpus installed)</span>
<span class="ansi-blue-fg">INFO:sagemaker_xgboost_container.training:Running XGBoost Sagemaker in algorithm mode</span>
<span class="ansi-blue-fg">INFO:root:Determined delimiter of CSV input is &#39;,&#39;</span>
<span class="ansi-blue-fg">INFO:root:Determined delimiter of CSV input is &#39;,&#39;</span>
<span class="ansi-blue-fg">INFO:root:Determined delimiter of CSV input is &#39;,&#39;</span>
<span class="ansi-blue-fg">INFO:root:Determined delimiter of CSV input is &#39;,&#39;</span>
<span class="ansi-blue-fg">INFO:root:Single node training.</span>
<span class="ansi-blue-fg">INFO:root:Train matrix has 4610 rows</span>
<span class="ansi-blue-fg">INFO:root:Validation matrix has 1977 rows</span>
<span class="ansi-blue-fg">[17:54:39] WARNING: ../src/objective/regression_obj.cu:174: reg:linear is now deprecated in favor of reg:squarederror.</span>
<span class="ansi-blue-fg">[0]#011train-rmse:0.79014#011validation-rmse:0.78483</span>
<span class="ansi-blue-fg">[1]#011train-rmse:0.69008#011validation-rmse:0.69400</span>
<span class="ansi-blue-fg">[2]#011train-rmse:0.61087#011validation-rmse:0.62580</span>
<span class="ansi-blue-fg">[3]#011train-rmse:0.55353#011validation-rmse:0.57829</span>
<span class="ansi-blue-fg">[4]#011train-rmse:0.50958#011validation-rmse:0.54266</span>
<span class="ansi-blue-fg">[5]#011train-rmse:0.47277#011validation-rmse:0.51461</span>
<span class="ansi-blue-fg">[6]#011train-rmse:0.44566#011validation-rmse:0.49453</span>
<span class="ansi-blue-fg">[7]#011train-rmse:0.42497#011validation-rmse:0.47962</span>
<span class="ansi-blue-fg">[8]#011train-rmse:0.40860#011validation-rmse:0.46705</span>
<span class="ansi-blue-fg">[9]#011train-rmse:0.39718#011validation-rmse:0.46049</span>
<span class="ansi-blue-fg">[10]#011train-rmse:0.38588#011validation-rmse:0.45371</span>
<span class="ansi-blue-fg">[11]#011train-rmse:0.37803#011validation-rmse:0.44784</span>
<span class="ansi-blue-fg">[12]#011train-rmse:0.37213#011validation-rmse:0.44465</span>
<span class="ansi-blue-fg">[13]#011train-rmse:0.36463#011validation-rmse:0.44022</span>
<span class="ansi-blue-fg">[14]#011train-rmse:0.36064#011validation-rmse:0.43627</span>
<span class="ansi-blue-fg">[15]#011train-rmse:0.35529#011validation-rmse:0.43212</span>
<span class="ansi-blue-fg">[16]#011train-rmse:0.35148#011validation-rmse:0.43007</span>
<span class="ansi-blue-fg">[17]#011train-rmse:0.34854#011validation-rmse:0.42757</span>
<span class="ansi-blue-fg">[18]#011train-rmse:0.34676#011validation-rmse:0.42632</span>
<span class="ansi-blue-fg">[19]#011train-rmse:0.34477#011validation-rmse:0.42534</span>
<span class="ansi-blue-fg">[20]#011train-rmse:0.34297#011validation-rmse:0.42405</span>
<span class="ansi-blue-fg">[21]#011train-rmse:0.34094#011validation-rmse:0.42318</span>
<span class="ansi-blue-fg">[22]#011train-rmse:0.33841#011validation-rmse:0.42140</span>
<span class="ansi-blue-fg">[23]#011train-rmse:0.33624#011validation-rmse:0.42078</span>
<span class="ansi-blue-fg">[24]#011train-rmse:0.33624#011validation-rmse:0.42078</span>
<span class="ansi-blue-fg">[25]#011train-rmse:0.33382#011validation-rmse:0.41874</span>
<span class="ansi-blue-fg">[26]#011train-rmse:0.33209#011validation-rmse:0.41872</span>
<span class="ansi-blue-fg">[27]#011train-rmse:0.32774#011validation-rmse:0.41662</span>
<span class="ansi-blue-fg">[28]#011train-rmse:0.32774#011validation-rmse:0.41662</span>
<span class="ansi-blue-fg">[29]#011train-rmse:0.32775#011validation-rmse:0.41663</span>
<span class="ansi-blue-fg">[30]#011train-rmse:0.32506#011validation-rmse:0.41543</span>
<span class="ansi-blue-fg">[31]#011train-rmse:0.32506#011validation-rmse:0.41543</span>
<span class="ansi-blue-fg">[32]#011train-rmse:0.32506#011validation-rmse:0.41543</span>
<span class="ansi-blue-fg">[33]#011train-rmse:0.32506#011validation-rmse:0.41543</span>
<span class="ansi-blue-fg">[34]#011train-rmse:0.32506#011validation-rmse:0.41543</span>
<span class="ansi-blue-fg">[35]#011train-rmse:0.32506#011validation-rmse:0.41543</span>
<span class="ansi-blue-fg">[36]#011train-rmse:0.32506#011validation-rmse:0.41543</span>
<span class="ansi-blue-fg">[37]#011train-rmse:0.32506#011validation-rmse:0.41543</span>
<span class="ansi-blue-fg">[38]#011train-rmse:0.32506#011validation-rmse:0.41543</span>
<span class="ansi-blue-fg">[39]#011train-rmse:0.32506#011validation-rmse:0.41543</span>
<span class="ansi-blue-fg">[40]#011train-rmse:0.32506#011validation-rmse:0.41543</span>
<span class="ansi-blue-fg">[41]#011train-rmse:0.32506#011validation-rmse:0.41544</span>
<span class="ansi-blue-fg">[42]#011train-rmse:0.32506#011validation-rmse:0.41544</span>
<span class="ansi-blue-fg">[43]#011train-rmse:0.32295#011validation-rmse:0.41409</span>
<span class="ansi-blue-fg">[44]#011train-rmse:0.32158#011validation-rmse:0.41344</span>
<span class="ansi-blue-fg">[45]#011train-rmse:0.32158#011validation-rmse:0.41343</span>
<span class="ansi-blue-fg">[46]#011train-rmse:0.32158#011validation-rmse:0.41343</span>
<span class="ansi-blue-fg">[47]#011train-rmse:0.32158#011validation-rmse:0.41343</span>
<span class="ansi-blue-fg">[48]#011train-rmse:0.32158#011validation-rmse:0.41343</span>
<span class="ansi-blue-fg">[49]#011train-rmse:0.32158#011validation-rmse:0.41343</span>
<span class="ansi-blue-fg">[50]#011train-rmse:0.31999#011validation-rmse:0.41251</span>
<span class="ansi-blue-fg">[51]#011train-rmse:0.31999#011validation-rmse:0.41251</span>
<span class="ansi-blue-fg">[52]#011train-rmse:0.31999#011validation-rmse:0.41251</span>
<span class="ansi-blue-fg">[53]#011train-rmse:0.32000#011validation-rmse:0.41251</span>
<span class="ansi-blue-fg">[54]#011train-rmse:0.31999#011validation-rmse:0.41251</span>
<span class="ansi-blue-fg">[55]#011train-rmse:0.31999#011validation-rmse:0.41251</span>
<span class="ansi-blue-fg">[56]#011train-rmse:0.31999#011validation-rmse:0.41251</span>
<span class="ansi-blue-fg">[57]#011train-rmse:0.31999#011validation-rmse:0.41251</span>
<span class="ansi-blue-fg">[58]#011train-rmse:0.31999#011validation-rmse:0.41251</span>
<span class="ansi-blue-fg">[59]#011train-rmse:0.31999#011validation-rmse:0.41251</span>
<span class="ansi-blue-fg">[60]#011train-rmse:0.31923#011validation-rmse:0.41215</span>
<span class="ansi-blue-fg">[61]#011train-rmse:0.31924#011validation-rmse:0.41215</span>
<span class="ansi-blue-fg">[62]#011train-rmse:0.31923#011validation-rmse:0.41215</span>
<span class="ansi-blue-fg">[63]#011train-rmse:0.31923#011validation-rmse:0.41215</span>
<span class="ansi-blue-fg">[64]#011train-rmse:0.31839#011validation-rmse:0.41165</span>
<span class="ansi-blue-fg">[65]#011train-rmse:0.31680#011validation-rmse:0.41002</span>
<span class="ansi-blue-fg">[66]#011train-rmse:0.31680#011validation-rmse:0.41002</span>
<span class="ansi-blue-fg">[67]#011train-rmse:0.31680#011validation-rmse:0.41002</span>
<span class="ansi-blue-fg">[68]#011train-rmse:0.31680#011validation-rmse:0.41002</span>
<span class="ansi-blue-fg">[69]#011train-rmse:0.31514#011validation-rmse:0.41000</span>
<span class="ansi-blue-fg">[70]#011train-rmse:0.31514#011validation-rmse:0.41000</span>
<span class="ansi-blue-fg">[71]#011train-rmse:0.31515#011validation-rmse:0.40999</span>
<span class="ansi-blue-fg">[72]#011train-rmse:0.31515#011validation-rmse:0.40999</span>
<span class="ansi-blue-fg">[73]#011train-rmse:0.31515#011validation-rmse:0.40999</span>
<span class="ansi-blue-fg">[74]#011train-rmse:0.31515#011validation-rmse:0.40999</span>
<span class="ansi-blue-fg">[75]#011train-rmse:0.31514#011validation-rmse:0.41000</span>
<span class="ansi-blue-fg">[76]#011train-rmse:0.31515#011validation-rmse:0.41001</span>
<span class="ansi-blue-fg">[77]#011train-rmse:0.31515#011validation-rmse:0.41000</span>
<span class="ansi-blue-fg">[78]#011train-rmse:0.31515#011validation-rmse:0.41000</span>
<span class="ansi-blue-fg">[79]#011train-rmse:0.31515#011validation-rmse:0.41000</span>
<span class="ansi-blue-fg">[80]#011train-rmse:0.31514#011validation-rmse:0.41000</span>
<span class="ansi-blue-fg">[81]#011train-rmse:0.31514#011validation-rmse:0.41000</span>
<span class="ansi-blue-fg">[82]#011train-rmse:0.31514#011validation-rmse:0.41000</span>
<span class="ansi-blue-fg">[83]#011train-rmse:0.31515#011validation-rmse:0.40999</span>
<span class="ansi-blue-fg">[84]#011train-rmse:0.31514#011validation-rmse:0.40999</span>
<span class="ansi-blue-fg">[85]#011train-rmse:0.31515#011validation-rmse:0.40999</span>
<span class="ansi-blue-fg">[86]#011train-rmse:0.31514#011validation-rmse:0.41000</span>
<span class="ansi-blue-fg">[87]#011train-rmse:0.31514#011validation-rmse:0.41000</span>
<span class="ansi-blue-fg">[88]#011train-rmse:0.31514#011validation-rmse:0.41000</span>
<span class="ansi-blue-fg">[89]#011train-rmse:0.31514#011validation-rmse:0.40999</span>
<span class="ansi-blue-fg">[90]#011train-rmse:0.31514#011validation-rmse:0.41000</span>
<span class="ansi-blue-fg">[91]#011train-rmse:0.31308#011validation-rmse:0.40913</span>
<span class="ansi-blue-fg">[92]#011train-rmse:0.31308#011validation-rmse:0.40913</span>
<span class="ansi-blue-fg">[93]#011train-rmse:0.31308#011validation-rmse:0.40913</span>
<span class="ansi-blue-fg">[94]#011train-rmse:0.31308#011validation-rmse:0.40913</span>
<span class="ansi-blue-fg">[95]#011train-rmse:0.31308#011validation-rmse:0.40913</span>
<span class="ansi-blue-fg">[96]#011train-rmse:0.31308#011validation-rmse:0.40913</span>
<span class="ansi-blue-fg">[97]#011train-rmse:0.31308#011validation-rmse:0.40913</span>
<span class="ansi-blue-fg">[98]#011train-rmse:0.31308#011validation-rmse:0.40913</span>
<span class="ansi-blue-fg">[99]#011train-rmse:0.31308#011validation-rmse:0.40913</span>
<span class="ansi-blue-fg">[17:54:40] WARNING: ../src/objective/regression_obj.cu:174: reg:linear is now deprecated in favor of reg:squarederror.</span>

2021-01-05 17:54:57 Uploading - Uploading generated training model
2021-01-05 17:54:57 Completed - Training job completed
Training seconds: 46
Billable seconds: 46
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predictor</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">deploy</span><span class="p">(</span>
    <span class="n">initial_instance_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
    <span class="n">instance_type</span><span class="o">=</span><span class="s1">&#39;ml.t2.medium&#39;</span><span class="p">,</span>
    <span class="n">serializer</span><span class="o">=</span><span class="n">sagemaker</span><span class="o">.</span><span class="n">serializers</span><span class="o">.</span><span class="n">CSVSerializer</span><span class="p">(),</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>---------------------!</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">endpoint_name</span><span class="o">=</span><span class="n">predictor</span><span class="o">.</span><span class="n">endpoint_name</span>
<span class="c1">#predictor.endpoint_name</span>
<span class="c1">#Store the endpoint name for later cleanup </span>
<span class="o">%</span><span class="k">store</span> endpoint_name
<span class="n">endpoint_name</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Stored &#39;endpoint_name&#39; (str)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;sagemaker-xgboost-2021-01-05-17-55-28-234&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(TESTING PURPOSE) Now to check that our endpoint is working, let's call it directly with a record from our test hold-out set.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Testing code for endpoint</span>
<span class="n">payload_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;target&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">=</span> <span class="n">payload_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">payload</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;0.528384279,0.467741935,0.347826087,0.120689655,0.481481481,0.6521739129999999,0.222222222,0.89211593,0.815234731,0.891824174,0.826809847,0.818747008,0.790460807,0.845313157,0.8135465000000001,0.952188843,0.966913627,0.001595844,0.031735957,0.407821166,0.4427397,0.906654154,0.7025761309999999,0.0,0.0,0.6677419689999999,0.6071359479999999,0.6016636639999999,0.6008397089999999,0.6265824729999999,0.65160482,0.695344011,0.641205199,0.352858223,0.362426861,0.495575534,0.288251453,0.507363451,0.246757564,0.422013598,0.27402085600000003,0.7520242079999999,0.767547988,0.247975792,0.273029205,0.37539531,0.20433238,0.309886113,0.304407087,0.238270631,0.221075679,0.236838573,0.262799678,0.334076875,0.332396145,0.003750389,0.005742277,0.475591607,0.8703220690000001,0.449176795,0.299913568,0.321962498,0.322896068,0.317556703,0.320800742,0.312070381,0.313770855,0.313072295,0.31379601100000004,0.780272629,0.7256131259999999,0.533413581,0.561219567,0.567581641,0.5251290679999999,0.587453926,0.597155654,0.654579548,0.658859218,0.656066615,0.6460508970000001,0.678739764,0.694673013,0.73408697,0.734159693,0.06496118,0.024459304,0.356061856,0.375025372,0.376197507,0.368124987,0.33101366600000004,0.332998568,0.310408517,0.304687332,0.932074385,0.912608131,0.039718891,0.13091892800000002,0.273478774,0.351279113,0.00985079,0.06804862,0.77932029,0.889879199,0.892085206,0.8359682159999999,0.551347335,0.34291684100000003,0.83160143,0.801750414,0.37722755,0.436862148,0.261414554,0.090391326,0.770538244,0.422222222,0.460606061,0.651785714,0.28571428600000004,0.432989691,0.582116788,0.642222222,0.553800982,0.100719424,0.456521739,0.3917525770000001,0.423580786,1.0,1609311810.4112825&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">float</span><span class="p">(</span><span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1.9875482320785522</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>rm train.csv
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>rm val.csv
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Making-predictions-using-streaming-aggregated-features">Making predictions using streaming aggregated features<a class="anchor-link" href="#Making-predictions-using-streaming-aggregated-features"> </a></h1><p>Now,we will input data to our input Kinesis stream and show that we can detect output.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Ensure-Lambda-knows-which-SageMaker-endpoint-to-use">Ensure Lambda knows which SageMaker endpoint to use<a class="anchor-link" href="#Ensure-Lambda-knows-which-SageMaker-endpoint-to-use"> </a></h3><p>Our Lambda function that invokes the endpoint thus needs a way to know the endpoint name. We handle that through a Lambda environment variable.</p>
<p>This section of code simply takes care of updating end ENDPOINT_NAME Lambda environment variable. It is important to do so before we start feeding transactions into our Kinesis stream.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Updating Lambda to use endpoint: </span><span class="si">{</span><span class="n">endpoint_name</span><span class="si">}</span><span class="s1"> for ARN: </span><span class="si">{</span><span class="n">lambda_to_model_arn</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">variables</span> <span class="o">=</span> <span class="n">lambda_client</span><span class="o">.</span><span class="n">get_function_configuration</span><span class="p">(</span><span class="n">FunctionName</span><span class="o">=</span><span class="n">lambda_to_model_arn</span><span class="p">)[</span><span class="s1">&#39;Environment&#39;</span><span class="p">][</span><span class="s1">&#39;Variables&#39;</span><span class="p">]</span>
<span class="n">variables</span><span class="p">[</span><span class="s1">&#39;ENDPOINT_NAME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">endpoint_name</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">lambda_client</span><span class="o">.</span><span class="n">update_function_configuration</span><span class="p">(</span>
    <span class="n">FunctionName</span><span class="o">=</span><span class="n">lambda_to_model_arn</span><span class="p">,</span>
      <span class="n">Environment</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;Variables&#39;</span><span class="p">:</span> <span class="n">variables</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Updating Lambda to use endpoint: sagemaker-xgboost-2021-01-05-17-55-28-234 for ARN: arn:aws:lambda:us-east-1:082830052325:function:HeidelbergInvokeFraudEndpointLambda3
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="DEPLOY-LINKS">DEPLOY LINKS<a class="anchor-link" href="#DEPLOY-LINKS"> </a></h2><h3 id="Lambda-functions">Lambda functions<a class="anchor-link" href="#Lambda-functions"> </a></h3><ol>
<li>InvokeFraudEndpoint (<a href="https://console.aws.amazon.com/lambda/home?region=us-east-1#/functions/HeidelbergInvokeFraudEndpointLambda3?tab=configuration">https://console.aws.amazon.com/lambda/home?region=us-east-1#/functions/HeidelbergInvokeFraudEndpointLambda3?tab=configuration</a>)</li>
<li>StreamingInjectAggregateFeature( <a href="https://console.aws.amazon.com/lambda/home?region=us-east-1#/functions/HeidelbergStreamingIngestAggFeatures3?tab=configuration">https://console.aws.amazon.com/lambda/home?region=us-east-1#/functions/HeidelbergStreamingIngestAggFeatures3?tab=configuration</a>)</li>
<li>Lambdatoputincomingdata ( <a href="https://console.aws.amazon.com/lambda/home?region=us-east-1#/functions/lambda_mlops?tab=configuration">https://console.aws.amazon.com/lambda/home?region=us-east-1#/functions/lambda_mlops?tab=configuration</a>)</li>
</ol>
<h3 id="Template-(CLoudFormation-Stack)">Template (CLoudFormation Stack)<a class="anchor-link" href="#Template-(CLoudFormation-Stack)"> </a></h3><p><a href="https://console.aws.amazon.com/cloudformation/home?region=us-east-1#/stacks/template?filteringText=&amp;filteringStatus=active&amp;viewNested=true&amp;hideStacks=false&amp;stackId=arn%3Aaws%3Acloudformation%3Aus-east-1%3A082830052325%3Astack%2Fheidelberg-mlops-stack-3%2Ffc283870-49d8-11eb-b6cb-0ea6aa6eaed9">https://console.aws.amazon.com/cloudformation/home?region=us-east-1#/stacks/template?filteringText=&amp;filteringStatus=active&amp;viewNested=true&amp;hideStacks=false&amp;stackId=arn%3Aaws%3Acloudformation%3Aus-east-1%3A082830052325%3Astack%2Fheidelberg-mlops-stack-3%2Ffc283870-49d8-11eb-b6cb-0ea6aa6eaed9</a></p>
<h3 id="LogStream-(CloudWatch)">LogStream (CloudWatch)<a class="anchor-link" href="#LogStream-(CloudWatch)"> </a></h3><h4 id="ENd-point-logstream,">ENd point logstream,<a class="anchor-link" href="#ENd-point-logstream,"> </a></h4><p><a href="https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Flambda$252FHeidelbergInvokeFraudEndpointLambda3">https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Flambda$252FHeidelbergInvokeFraudEndpointLambda3</a></p>
<h4 id="Update-FeatureStore-Logstream">Update FeatureStore Logstream<a class="anchor-link" href="#Update-FeatureStore-Logstream"> </a></h4><p><a href="https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Flambda$252FHeidelbergStreamingIngestAggFeatures3">https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Flambda$252FHeidelbergStreamingIngestAggFeatures3</a></p>
<h4 id="Streaming-lambda">Streaming lambda<a class="anchor-link" href="#Streaming-lambda"> </a></h4><p><a href="https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Flambda$252Flambda_mlops">https://console.aws.amazon.com/cloudwatch/home?region=us-east-1#logsV2:log-groups/log-group/$252Faws$252Flambda$252Flambda_mlops</a></p>
<h3 id="KDA-Application">KDA Application<a class="anchor-link" href="#KDA-Application"> </a></h3><p><a href="https://console.aws.amazon.com/kinesisanalytics/home?region=us-east-1#/wizard/hub?applicationName=heidelberg-mlops-app">https://console.aws.amazon.com/kinesisanalytics/home?region=us-east-1#/wizard/hub?applicationName=heidelberg-mlops-app</a></p>
<h3 id="Real-time-lambda-update-s3-bucket">Real time lambda update s3 bucket<a class="anchor-link" href="#Real-time-lambda-update-s3-bucket"> </a></h3><p><a href="https://s3.console.aws.amazon.com/s3/buckets/lambda-trigger-mlops?region=us-east-1&amp;tab=objects">https://s3.console.aws.amazon.com/s3/buckets/lambda-trigger-mlops?region=us-east-1&amp;tab=objects</a></p>

</div>
</div>
</div>
</div>
 

