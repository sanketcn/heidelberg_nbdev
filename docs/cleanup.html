---

title: Cleanup


keywords: fastai
sidebar: home_sidebar

summary: "This notebook is provided to help you clean up any resources you have created by running through the example. You should also go to the <a href='https://console.aws.amazon.com/cloudformation/home'>CloudFormation console</a> and delete the stack that you created."
description: "This notebook is provided to help you clean up any resources you have created by running through the example. You should also go to the <a href='https://console.aws.amazon.com/cloudformation/home'>CloudFormation console</a> and delete the stack that you created."
nb_path: "3_cleanup.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 3_cleanup.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sagemaker</span> <span class="kn">import</span> <span class="n">get_execution_role</span>
<span class="kn">import</span> <span class="nn">sagemaker</span>
<span class="kn">import</span> <span class="nn">boto3</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">role</span> <span class="o">=</span> <span class="n">get_execution_role</span><span class="p">()</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="n">service_name</span><span class="o">=</span><span class="s1">&#39;sagemaker&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Delete-feature-groups">Delete feature groups<a class="anchor-link" href="#Delete-feature-groups"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">store</span> -r
<span class="k">try</span><span class="p">:</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">delete_feature_group</span><span class="p">(</span><span class="n">FeatureGroupName</span><span class="o">=</span><span class="n">fg_name</span><span class="p">)</span> 
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;deleted &#39;</span><span class="o">+</span><span class="n">fg_name</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>deleted heidelberg-mlops-fg
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sm</span><span class="o">.</span><span class="n">list_feature_groups</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;FeatureGroupSummaries&#39;: [{&#39;FeatureGroupName&#39;: &#39;transaction-feature-group-15-05-22-59&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/transaction-feature-group-15-05-22-59&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2020, 12, 15, 5, 23, 10, 113000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Created&#39;,
   &#39;OfflineStoreStatus&#39;: {&#39;Status&#39;: &#39;Active&#39;}},
  {&#39;FeatureGroupName&#39;: &#39;ml-ops-2&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/ml-ops-2&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2020, 12, 19, 6, 49, 19, 335000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Created&#39;},
  {&#39;FeatureGroupName&#39;: &#39;ml-ops-1&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/ml-ops-1&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2020, 12, 18, 7, 7, 15, 38000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Created&#39;},
  {&#39;FeatureGroupName&#39;: &#39;identity-feature-group-15-05-22-59&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/identity-feature-group-15-05-22-59&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2020, 12, 15, 5, 23, 7, 513000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Created&#39;,
   &#39;OfflineStoreStatus&#39;: {&#39;Status&#39;: &#39;Active&#39;}},
  {&#39;FeatureGroupName&#39;: &#39;heidelberg-mlops-fg-test1&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/heidelberg-mlops-fg-test1&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2020, 12, 30, 6, 41, 36, 615000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Created&#39;},
  {&#39;FeatureGroupName&#39;: &#39;heidelberg-mlops-fg&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/heidelberg-mlops-fg&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2021, 1, 5, 17, 49, 57, 235000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Deleting&#39;,
   &#39;OfflineStoreStatus&#39;: {&#39;Status&#39;: &#39;Active&#39;}},
  {&#39;FeatureGroupName&#39;: &#39;heidelberg-fg-test2&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/heidelberg-fg-test2&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2020, 12, 29, 9, 18, 2, 298000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Created&#39;},
  {&#39;FeatureGroupName&#39;: &#39;heidelberg-fg-test&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/heidelberg-fg-test&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2020, 12, 29, 8, 57, 48, 782000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Created&#39;},
  {&#39;FeatureGroupName&#39;: &#39;demo-feature-group-2&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/demo-feature-group-2&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2020, 12, 29, 4, 56, 13, 540000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Created&#39;},
  {&#39;FeatureGroupName&#39;: &#39;demo-feature-group&#39;,
   &#39;FeatureGroupArn&#39;: &#39;arn:aws:sagemaker:us-east-1:082830052325:feature-group/demo-feature-group&#39;,
   &#39;CreationTime&#39;: datetime.datetime(2020, 12, 28, 6, 17, 12, 601000, tzinfo=tzlocal()),
   &#39;FeatureGroupStatus&#39;: &#39;Created&#39;}],
 &#39;NextToken&#39;: &#39;cIws2QhTXUIa8bi8XYNGwqMND6lavWZ6uZcw9539cUOD10M54amsd7l7yk4ucGW0YBYA+27e3qBpT0v/9eeXaZHI0OynQP0MGWxQIEMxEgPAFTlgHQc4BCc2dClH5/oyLuP4y3HU1Uc+hOt7PjxjfX85eToHqu60szYdvyQww5AIcHO98C+c6aArPfKWA9At4vupqSH+tFFjELqIHIc4VppahmW2c4V08+Ih3icbhVTdkJqtxW32ij3UaIEmXVj2ewAC85aPdqMp6PHmaua2EO6cdfewvaM4/TDk1kXkJblj4Un+QvQlTqL5q5HpO1LGfU5HIKxZNaoe3bC/szFmTTELP1QnIafcIPijnSvnTmHuytOw/Nk8pEhlABQ8yNBEQvy6Rh0cwxasIJdvzO/THM/8QwFTHXtTwp24StY+widOwWlh0SqGCdR/8UxYEFQEUZ3t4fi08RtBh8aQeWYadbd8IwJv6rLl4yUhEZM4KKxVoHI/B5Ge/Sg4Lf3Pq9wK3nS3QowfTbCLYj8CLs6tfvTfAQ==&#39;,
 &#39;ResponseMetadata&#39;: {&#39;RequestId&#39;: &#39;ae9c6043-c054-4b4d-93e1-4bd299a61749&#39;,
  &#39;HTTPStatusCode&#39;: 200,
  &#39;HTTPHeaders&#39;: {&#39;x-amzn-requestid&#39;: &#39;ae9c6043-c054-4b4d-93e1-4bd299a61749&#39;,
   &#39;content-type&#39;: &#39;application/x-amz-json-1.1&#39;,
   &#39;content-length&#39;: &#39;2747&#39;,
   &#39;date&#39;: &#39;Tue, 05 Jan 2021 18:13:27 GMT&#39;},
  &#39;RetryAttempts&#39;: 0}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Stop-the-KDA-SQL-App">Stop the KDA SQL App<a class="anchor-link" href="#Stop-the-KDA-SQL-App"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">store</span> -r
<span class="kn">import</span> <span class="nn">boto3</span>
<span class="n">kda_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;kinesisanalytics&#39;</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">kda_client</span><span class="o">.</span><span class="n">stop_application</span><span class="p">(</span><span class="n">ApplicationName</span><span class="o">=</span><span class="n">APPLICATION_NAME</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Stopped the KDA SQL app&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Stopped the KDA SQL app
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Delete-the-KDA-SQL-App">Delete the KDA SQL App<a class="anchor-link" href="#Delete-the-KDA-SQL-App"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="o">%</span><span class="k">store</span> -r 

<span class="k">try</span><span class="p">:</span>
    <span class="n">ready</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">ready</span><span class="p">:</span>
        <span class="n">app_desc</span> <span class="o">=</span> <span class="n">kda_client</span><span class="o">.</span><span class="n">describe_application</span><span class="p">(</span><span class="n">ApplicationName</span><span class="o">=</span><span class="n">APPLICATION_NAME</span><span class="p">)[</span><span class="s1">&#39;ApplicationDetail&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">app_desc</span><span class="p">[</span><span class="s1">&#39;ApplicationStatus&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;READY&#39;</span><span class="p">:</span>
            <span class="n">ready</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Waiting for KDA SQL app to be ready for deletion...&#39;</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">create_timestamp</span> <span class="o">=</span> <span class="n">app_desc</span><span class="p">[</span><span class="s1">&#39;CreateTimestamp&#39;</span><span class="p">]</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">kda_client</span><span class="o">.</span><span class="n">delete_application</span><span class="p">(</span><span class="n">ApplicationName</span><span class="o">=</span><span class="n">APPLICATION_NAME</span><span class="p">,</span>
                                  <span class="n">CreateTimestamp</span><span class="o">=</span><span class="n">create_timestamp</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Deleted KDA SQL app&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;FAILED to delete KDA sql app&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Waiting for KDA SQL app to be ready for deletion...
Deleted KDA SQL app
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Remove-the-trigger-from-Lambda">Remove the trigger from Lambda<a class="anchor-link" href="#Remove-the-trigger-from-Lambda"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">boto3</span>

<span class="o">%</span><span class="k">store</span> -r 

<span class="n">lambda_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;lambda&#39;</span><span class="p">)</span>
<span class="n">paginator</span> <span class="o">=</span> <span class="n">lambda_client</span><span class="o">.</span><span class="n">get_paginator</span><span class="p">(</span><span class="s1">&#39;list_event_source_mappings&#39;</span><span class="p">)</span>
<span class="n">mapping_iterator</span> <span class="o">=</span> <span class="n">paginator</span><span class="o">.</span><span class="n">paginate</span><span class="p">(</span><span class="n">FunctionName</span><span class="o">=</span><span class="n">lambda_to_model_arn</span><span class="p">)</span>

<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">mapping_iterator</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;EventSourceMappings&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">uuid</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;EventSourceMappings&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;UUID&#39;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Deleting mapping: </span><span class="si">{</span><span class="n">uuid</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">)</span>
        <span class="n">lambda_client</span><span class="o">.</span><span class="n">delete_event_source_mapping</span><span class="p">(</span><span class="n">UUID</span><span class="o">=</span><span class="n">uuid</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Deleting mapping: 9974f2db-2d9a-4081-9e31-7cbb227ca548...
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Delete-the-Kinesis-data-stream">Delete the Kinesis data stream<a class="anchor-link" href="#Delete-the-Kinesis-data-stream"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">store</span> -r
<span class="n">kinesis_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;kinesis&#39;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">kinesis_client</span><span class="o">.</span><span class="n">delete_stream</span><span class="p">(</span><span class="n">StreamName</span><span class="o">=</span><span class="n">STREAM_NAME</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;deleted Kinesis stream&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>deleted Kinesis stream
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Delete-the-SageMaker-endpoint">Delete the SageMaker endpoint<a class="anchor-link" href="#Delete-the-SageMaker-endpoint"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">store</span> -r
<span class="c1">#endpoint_name=&quot;sagemaker-xgboost-2020-12-23-06-52-57-726&quot;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">sm</span><span class="o">.</span><span class="n">delete_endpoint</span><span class="p">(</span><span class="n">EndpointName</span><span class="o">=</span><span class="n">endpoint_name</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;yes&quot;</span><span class="p">)</span>
    <span class="k">pass</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

